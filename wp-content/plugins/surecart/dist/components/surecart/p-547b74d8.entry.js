import{r as o,h as s,F as i}from"./p-cc7ce8c7.js";import{s as t}from"./p-c3d54c20.js";import"./p-dd7d2638.js";import{s as e,c as r,f as d,e as l,b as n}from"./p-d8da6b4d.js";import{e as a,s as c}from"./p-24f06282.js";import{a as p}from"./p-b3738db2.js";import{l as u,b as m}from"./p-58517bdd.js";import{a as v}from"./p-18e45a13.js";import{a as f,M as h}from"./p-9eed9ef6.js";import{c as y}from"./p-8266bbed.js";import{a as b}from"./p-1c2e2695.js";import{s as j}from"./p-38a11668.js";import{o as g}from"./p-c27fae79.js";import{c as k}from"./p-a27e9b70.js";import{u as w}from"./p-f9c1f513.js";import"./p-25433d0f.js";import"./p-c06b2e12.js";import"./p-f70181c4.js";import"./p-4d73f82a.js";import"./p-830ab1a3.js";import"./p-a3a138d6.js";import"./p-7ef0f71c.js";import"./p-50da3ba3.js";import"./p-e64f9fcd.js";import"./p-5ec5df35.js";const _=(o,s,i)=>a("set",((t,e,r)=>{if(t!==o)return;if(Array.isArray(s)){if(s.some((o=>JSON.stringify(e===null||e===void 0?void 0:e[o])!==JSON.stringify(r===null||r===void 0?void 0:r[o])))){return i(e,r)}}if(typeof s==="string"){if(JSON.stringify(e===null||e===void 0?void 0:e[s])===JSON.stringify(r===null||r===void 0?void 0:r[s]))return;return i(e===null||e===void 0?void 0:e[s],r===null||r===void 0?void 0:r[s])}}));const S=":host{display:block}";const J=class{constructor(s){o(this,s);this.processorId=undefined;this.method=undefined;this.error=undefined;this.methods=undefined}componentWillLoad(){t.id="mollie";this.fetchMethods();_("checkout",["total_amount","currency","reusabled_payment_method_required","shipping_address"],(()=>this.fetchMethods()))}async fetchMethods(){var o;const s=c.checkout;if(!(s===null||s===void 0?void 0:s.currency)||!(s===null||s===void 0?void 0:s.total_amount))return;try{u("methods");const i=await v({path:b(`surecart/v1/processors/${this.processorId}/payment_method_types`,{amount:s===null||s===void 0?void 0:s.total_amount,country:((o=s===null||s===void 0?void 0:s.shipping_address)===null||o===void 0?void 0:o.country)||"us",currency:s===null||s===void 0?void 0:s.currency,...(s===null||s===void 0?void 0:s.reusable_payment_method_required)?{reusable:s===null||s===void 0?void 0:s.reusable_payment_method_required}:{},per_page:100})});e.methods=(i===null||i===void 0?void 0:i.data)||[]}catch(o){y(o);console.error(o)}finally{m("methods")}}renderLoading(){return s("sc-card",null,s("sc-skeleton",{style:{width:"50%",marginBottom:"0.5em"}}),s("sc-skeleton",{style:{width:"30%",marginBottom:"0.5em"}}),s("sc-skeleton",{style:{width:"60%",marginBottom:"0.5em"}}))}render(){var o,t,e;if(p("methods")&&!((o=r())===null||o===void 0?void 0:o.length)){return this.renderLoading()}if(!((t=c.checkout)===null||t===void 0?void 0:t.currency)){return this.renderLoading()}if(!((e=r())===null||e===void 0?void 0:e.length)){return s("sc-alert",{type:"warning",open:true},wp.i18n.__("No available payment methods","surecart")," ")}const a=d()?"sc-toggles":"div";return s(i,null,s(a,{collapsible:false,theme:"container"},(r()||[]).map((o=>s("sc-payment-method-choice",{"processor-id":"mollie","method-id":o===null||o===void 0?void 0:o.id,key:o===null||o===void 0?void 0:o.id},s("span",{slot:"summary",class:"sc-payment-toggle-summary"},!!(o===null||o===void 0?void 0:o.image)&&s("img",{src:o===null||o===void 0?void 0:o.image,"aria-hidden":"true"}),s("span",null,o===null||o===void 0?void 0:o.description)),s("sc-card",null,s("sc-payment-selected",{label:wp.i18n.sprintf(wp.i18n.__("%s selected for check out.","surecart"),o===null||o===void 0?void 0:o.description)},!!(o===null||o===void 0?void 0:o.image)&&s("img",{slot:"icon",src:o===null||o===void 0?void 0:o.image,style:{width:"32px"}}),wp.i18n.__("Another step will appear after submitting your order to complete your purchase details.","surecart")))))),s(f,{processor:l("mock")}),s(h,{methods:n()})),!!p("methods")&&s("sc-block-ui",{class:"busy-block-ui","z-index":9,style:{"--sc-block-ui-opacity":"0.4"}}))}};J.style=S;const C=class{constructor(s){o(this,s)}componentWillLoad(){this.unlistenToFormState=g("formState",(()=>{if("paying"===k()){this.confirm()}}))}disconnectedCallback(){this.unlistenToFormState()}async confirm(){var o,s,i,e;if((t===null||t===void 0?void 0:t.id)!=="paystack")return;if(!((s=(o=c===null||c===void 0?void 0:c.checkout)===null||o===void 0?void 0:o.payment_intent)===null||s===void 0?void 0:s.processor_data.paystack))return;if(((i=c===null||c===void 0?void 0:c.checkout)===null||i===void 0?void 0:i.status)==="paid")return;try{const{public_key:o,access_code:s}=(e=c===null||c===void 0?void 0:c.checkout)===null||e===void 0?void 0:e.payment_intent.processor_data.paystack;if(!o||!s){y({message:wp.i18n.sprintf(wp.i18n.__("Payment gateway configuration incomplete. Please ensure Paystack is properly configured for transactions.","surecart"))});return}const i=new j;await i.newTransaction({key:o,accessCode:s,onSuccess:async o=>{if((o===null||o===void 0?void 0:o.status)!=="success"){throw{message:wp.i18n.sprintf(wp.i18n.__("Paystack transaction could not be finished. Status: %s","surecart"),o===null||o===void 0?void 0:o.status)}}return w("PAID")},onClose:()=>w("REJECT")})}catch(o){y(o);console.error(o);w("REJECT")}}};export{J as sc_checkout_mollie_payment,C as sc_checkout_paystack_payment_provider};
//# sourceMappingURL=p-547b74d8.entry.js.map