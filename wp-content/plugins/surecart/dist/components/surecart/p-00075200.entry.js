import{r as s,h as t,F as e,a as i}from"./p-cc7ce8c7.js";import{o as l}from"./p-c2833cb1.js";import{a as n}from"./p-18e45a13.js";import{a}from"./p-1c2e2695.js";const c=":host{display:block}.license__date{font-weight:var(--sc-font-weight-semibold)}.license__heading{display:flex;align-items:center;gap:1rem}.license__key{display:block}.close__button{position:absolute;top:0;right:0;font-size:22px;z-index:1}.license-cancel{display:grid;gap:0.5em}";const o=class{constructor(t){s(this,t);this.deleteActivation=async()=>{try{this.busy=true;await n({path:`surecart/v1/activations/${this.selectedActivationId}`,method:"DELETE"});this.onCloseDeleteModal();await this.initialFetch()}catch(s){console.error(s);this.deleteActivationError=(s===null||s===void 0?void 0:s.message)||wp.i18n.__("Something went wrong","surecart")}finally{this.busy=false}};this.onCloseDeleteModal=()=>{this.selectedActivationId="";this.showConfirmDelete=false;this.busy=false;this.deleteActivationError=""};this.licenseId=undefined;this.loading=false;this.error="";this.license=undefined;this.copied=false;this.showConfirmDelete=false;this.selectedActivationId="";this.deleteActivationError="";this.busy=false}componentWillLoad(){l(this.el,(()=>{this.initialFetch()}))}async initialFetch(){try{this.loading=true;await this.getLicense()}catch(s){console.error(s);this.error=(s===null||s===void 0?void 0:s.message)||wp.i18n.__("Something went wrong","surecart")}finally{this.loading=false}}async getLicense(){this.license=await n({path:a(`surecart/v1/licenses/${this.licenseId}`,{expand:["activations","purchase","purchase.product"]})})}async copyKey(s){try{await navigator.clipboard.writeText(s);this.copied=true;setTimeout((()=>{this.copied=false}),2e3)}catch(s){console.error(s);alert(wp.i18n.__("Error copying to clipboard","surecart"))}}renderStatus(){var s,e,i,l;if(((s=this.license)===null||s===void 0?void 0:s.status)==="active"){return t("sc-tag",{type:"success"},wp.i18n.__("Active","surecart"))}if(((e=this.license)===null||e===void 0?void 0:e.status)==="revoked"){return t("sc-tag",{type:"danger"},wp.i18n.__("Revoked","surecart"))}if(((i=this.license)===null||i===void 0?void 0:i.status)==="inactive"){return t("sc-tag",{type:"info"},wp.i18n.__("Inactive","surecart"))}return t("sc-tag",{type:"info"},(l=this.license)===null||l===void 0?void 0:l.status)}renderLoading(){return t("sc-dashboard-module",null,t("span",{slot:"heading"},t("sc-skeleton",{style:{width:"120px"}})),t("sc-card",null,t("sc-stacked-list",null,t("sc-flex",{flexDirection:"column",style:{gap:"1em"}},t("sc-skeleton",{style:{width:"20%",display:"inline-block"}}),t("sc-skeleton",{style:{width:"60%",display:"inline-block"}}),t("sc-skeleton",{style:{width:"40%",display:"inline-block"}})))))}renderEmpty(){return t("sc-empty",{icon:"activity"},wp.i18n.__("License not found.","surecart"))}renderLicenseHeader(){var s;const i=(s=this.license)===null||s===void 0?void 0:s.purchase;const l=i===null||i===void 0?void 0:i.product;return t(e,null,t("span",{slot:"heading"},t("div",{class:"license__heading"},l===null||l===void 0?void 0:l.name,!this.loading&&!i.live_mode&&t("sc-tag",{type:"warning",size:"small"},wp.i18n.__("Test Mode","surecart")))))}renderContent(){var s,i,l,n,a,c,o,r,d,u;if(this.loading&&!((s=this.license)===null||s===void 0?void 0:s.id)){return this.renderLoading()}if(!((i=this.license)===null||i===void 0?void 0:i.id)){return this.renderEmpty()}return t(e,null,t("sc-dashboard-module",{error:this.error},this.renderLicenseHeader(),t("sc-card",{noPadding:true},t("sc-stacked-list",null,t("sc-stacked-list-row",{style:{"--columns":"2","--sc-stacked-list-row-align-items":"center"}},t("div",null,wp.i18n.__("License Status","surecart")),this.renderStatus()),t("sc-stacked-list-row",{style:{"--columns":"2"}},t("div",null,wp.i18n.__("License Key","surecart")),t("div",{class:"license__key"},t("sc-input",{value:(l=this.license)===null||l===void 0?void 0:l.key,readonly:true},t("sc-button",{class:"license__copy",type:"default",size:"small",slot:"suffix",onClick:()=>{var s;return this.copyKey((s=this.license)===null||s===void 0?void 0:s.key)}},this.copied?wp.i18n.__("Copied!","surecart"):wp.i18n.__("Copy","surecart"))))),t("sc-stacked-list-row",{style:{"--columns":"2"}},t("div",null,wp.i18n.__("Date","surecart")),t("sc-format-date",{date:(n=this.license)===null||n===void 0?void 0:n.created_at,type:"timestamp",month:"short",day:"numeric",year:"numeric"})),t("sc-stacked-list-row",{style:{"--columns":"2"}},t("div",null,wp.i18n.__("Activations Count","surecart")),t("span",null,(a=this.license)===null||a===void 0?void 0:a.activation_count," / ",((c=this.license)===null||c===void 0?void 0:c.activation_limit)||t("span",null,"âˆž")))))),t("sc-dashboard-module",null,t("span",{slot:"heading"},t("slot",{name:"heading"},wp.i18n.__("Activations","surecart"))),t("sc-card",{noPadding:true},!!((d=(r=(o=this.license)===null||o===void 0?void 0:o.activations)===null||r===void 0?void 0:r.data)===null||d===void 0?void 0:d.length)?t("sc-stacked-list",null,(u=this.license)===null||u===void 0?void 0:u.activations.data.map((s=>t("sc-stacked-list-row",{style:{"--columns":"4"}},t("sc-format-date",{class:"license__date",date:s.created_at,type:"timestamp",month:"short",day:"numeric",year:"numeric"}),t("div",null,s.name),t("div",null,s.fingerprint),t("div",null,t("sc-button",{size:"small",onClick:()=>{this.selectedActivationId=s.id;this.showConfirmDelete=true}},"Delete")))))):t("sc-empty",null,wp.i18n.__("No activations present.","surecart")),this.loading&&t("sc-block-ui",{style:{"--sc-block-ui-opacity":"0.75"},spinner:true}))))}renderConfirmDelete(){return t("sc-dialog",{open:this.showConfirmDelete,style:{"--body-spacing":"var(--sc-spacing-x-large)"},noHeader:true,onScRequestClose:this.onCloseDeleteModal},t("sc-button",{class:"close__button",type:"text",circle:true,onClick:this.onCloseDeleteModal,disabled:this.loading},t("sc-icon",{name:"x"})),t("sc-dashboard-module",{heading:wp.i18n.__("Delete Activation","surecart"),class:"license-cancel",error:this.error,style:{"--sc-dashboard-module-spacing":"1em"}},t("span",{slot:"description"},wp.i18n.__("Are you sure you want to delete activation?","surecart")),t("sc-flex",{justifyContent:"flex-start"},t("sc-button",{type:"primary",disabled:this.loading||this.busy,onClick:this.deleteActivation},wp.i18n.__("Delete Activation","surecart")),t("sc-button",{style:{color:"var(--sc-color-gray-500"},type:"text",onClick:this.onCloseDeleteModal,disabled:this.loading||this.busy},wp.i18n.__("Cancel","surecart"))),this.busy&&t("sc-block-ui",{style:{"--sc-block-ui-opacity":"0.75"},spinner:true})))}render(){return t("sc-spacing",{style:{"--spacing":"var(--sc-spacing-large)"}},this.renderContent(),this.renderConfirmDelete())}get el(){return i(this)}};o.style=c;export{o as sc_license};
//# sourceMappingURL=p-00075200.entry.js.map