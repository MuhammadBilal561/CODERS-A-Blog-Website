{"version":3,"names":["scOrderSummaryCss","wp","i18n","__","sprintf","this","collapsed","onKeyDown","e","openText","h","xmlns","class","fill","viewBox","stroke","d","slot","name","_d","state","checkout","total_amount","_e","amount_due","price","type","currency","_f","value","_g","_h","total_savings_amount","_j","_k","_l","total","order","setDefaultAnimation"],"sources":["./src/components/controllers/checkout-form/order-summary/sc-order-summary.scss?tag=sc-order-summary&encapsulation=shadow","./src/components/controllers/checkout-form/order-summary/sc-order-summary.tsx"],"sourcesContent":[":host {\n  display: block;\n  font-family: var(--sc-font-sans);\n  font-size: var(--sc-checkout-font-size, 16px);\n}\n\n.collapse-link {\n  display: flex;\n  align-items: center;\n  gap: 0.35em;\n}\n\n.summary__content--empty {\n  display: none;\n}\n\n.collapse-link__icon {\n  width: 18px;\n  height: 18px;\n  color: var(--sc-order-collapse-link-icon-color, var(--sc-color-gray-500));\n}\n\n.item__product + .item__product {\n  margin-top: 20px;\n}\n\n.empty {\n  color: var(--sc-order-summary-color, var(--sc-color-gray-500));\n}\n\n.price {\n  display: inline-block;\n  opacity: 0;\n  visibility: hidden;\n  transform: translateY(5px);\n  transition: var(--sc-input-transition, var(--sc-transition-medium)) visibility ease, var(--sc-input-transition, var(--sc-transition-medium)) opacity ease,\n    var(--sc-input-transition, var(--sc-transition-medium)) transform ease;\n\n  &--collapsed {\n    opacity: 1;\n    visibility: visible;\n    transform: translateY(0);\n  }\n}\n\n.summary {\n  position: relative;\n  user-select: none;\n  cursor: pointer;\n\n  .collapse-link__icon {\n    transition: transform 0.25s ease-in-out;\n  }\n\n  .scratch-price {\n    text-decoration: line-through;\n    color: var(--sc-color-gray-500);\n    font-size: var(--sc-font-size-small);\n    margin-right: var(--sc-spacing-xx-small);\n  }\n\n  &--open {\n    .collapse-link__icon {\n      transform: rotate(180deg);\n    }\n  }\n}\n\n::slotted(*) {\n  margin: 4px 0 !important;\n}\n::slotted(sc-divider) {\n  margin: 16px 0 !important;\n}\nsc-line-item ~ sc-line-item {\n  margin-top: 14px;\n}\n\n.total-price {\n  white-space: nowrap;\n}\n","import { Component, Element, Event, EventEmitter, h, Prop, Watch } from '@stencil/core';\nimport { __, sprintf } from '@wordpress/i18n';\nimport { speak } from '@wordpress/a11y';\n\nimport { state as checkoutState } from '@store/checkout';\nimport { formBusy, formLoading } from '@store/form/getters';\nimport { animateTo, shimKeyframesHeightAuto, stopAnimations } from '../../../../functions/animate';\nimport { getAnimation, setDefaultAnimation } from '../../../../functions/animation-registry';\nimport { Checkout } from '../../../../types';\n\n@Component({\n  tag: 'sc-order-summary',\n  styleUrl: 'sc-order-summary.scss',\n  shadow: true,\n})\nexport class ScOrderSummary {\n  private body: HTMLElement;\n  @Element() el: HTMLScOrderSummaryElement;\n  @Prop() order: Checkout;\n  @Prop() busy: boolean;\n  @Prop() closedText: string = __('Show Summary', 'surecart');\n  @Prop() openText: string = __('Summary', 'surecart');\n  @Prop() collapsible: boolean = false;\n  @Prop() collapsedOnMobile: boolean = false;\n  @Prop() collapsedOnDesktop: boolean;\n\n  @Prop({ mutable: true }) collapsed: boolean = false;\n\n  /** Show the toggle */\n  @Event() scShow: EventEmitter<void>;\n\n  /** Show the toggle */\n  @Event() scHide: EventEmitter<void>;\n\n  isMobileScreen(): boolean {\n    const bodyRect = document.body?.getClientRects();\n    return bodyRect?.length && bodyRect[0]?.width < 781;\n  }\n\n  componentWillLoad() {\n    if (this.isMobileScreen()) {\n      this.collapsed = this.collapsed || this.collapsedOnMobile;\n    } else {\n      this.collapsed = this.collapsed || this.collapsedOnDesktop;\n    }\n\n    this.handleOpenChange();\n  }\n\n  handleClick(e) {\n    e.preventDefault();\n    if (this.empty() && !formBusy()) return;\n    this.collapsed = !this.collapsed;\n  }\n\n  /** It's empty if there are no items or the mode does not match. */\n  empty() {\n    return !checkoutState.checkout?.line_items?.pagination?.count || (checkoutState?.checkout?.live_mode ? checkoutState?.mode === 'test' : checkoutState?.mode === 'live');\n  }\n\n  renderHeader() {\n    // busy state\n    if ((formBusy() || formLoading()) && !checkoutState.checkout?.line_items?.data?.length) {\n      return (\n        <sc-line-item>\n          <sc-skeleton slot=\"title\" style={{ width: '120px', display: 'inline-block' }}></sc-skeleton>\n          <sc-skeleton slot=\"price\" style={{ 'width': '70px', 'display': 'inline-block', '--border-radius': '6px' }}></sc-skeleton>\n          <sc-skeleton slot=\"currency\" style={{ width: '30px', display: 'inline-block' }}></sc-skeleton>\n        </sc-line-item>\n      );\n    }\n\n    return (\n      <sc-line-item style={{ '--price-size': 'var(--sc-font-size-x-large)' }}>\n        <span\n          class=\"collapse-link\"\n          slot=\"title\"\n          onClick={e => this.handleClick(e)}\n          tabIndex={0}\n          aria-label={sprintf(__('Order Summary %1$s', 'surecart'), this.collapsed ? __('collapsed', 'surecart') : __('expanded', 'surecart'))}\n          onKeyDown={e => {\n            if (e.key === ' ') {\n              this.handleClick(e);\n              speak(sprintf(__('Order Summary %1$s', 'surecart'), this.collapsed ? __('collapsed', 'surecart') : __('expanded', 'surecart')), 'assertive');\n            }\n          }}\n        >\n          {this.collapsed ? this.closedText || __('Order Summary', 'surecart') : this.openText || __('Order Summary', 'surecart')}\n          <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"collapse-link__icon\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M19 9l-7 7-7-7\" />\n          </svg>\n        </span>\n        <span slot=\"description\">\n          <slot name=\"description\" />\n        </span>\n\n        {/* We have a trial, do not show total_savings_amount since it's based on the total_amount */}\n        {checkoutState.checkout?.total_amount !== checkoutState.checkout?.amount_due ? (\n          <span slot=\"price\" class={{ 'price': true, 'price--collapsed': this.collapsed }}>\n            <sc-format-number class=\"total-price\" type=\"currency\" currency={checkoutState.checkout?.currency} value={checkoutState.checkout?.amount_due}></sc-format-number>\n          </span>\n        ) : (\n          <span slot=\"price\" class={{ 'price': true, 'price--collapsed': this.collapsed }}>\n            {!!checkoutState.checkout?.total_savings_amount && (\n              <sc-format-number\n                class=\"total-price scratch-price\"\n                type=\"currency\"\n                value={-checkoutState.checkout?.total_savings_amount + checkoutState.checkout?.total_amount}\n                currency={checkoutState.checkout?.currency || 'usd'}\n              />\n            )}\n            <sc-total class=\"total-price\" total={'total'} order={checkoutState.checkout}></sc-total>\n          </span>\n        )}\n      </sc-line-item>\n    );\n  }\n\n  @Watch('collapsed')\n  async handleOpenChange() {\n    if (!this.collapsed) {\n      this.scShow.emit();\n      await stopAnimations(this.body);\n      this.body.hidden = false;\n      this.body.style.overflow = 'hidden';\n      const { keyframes, options } = getAnimation(this.el, 'summary.show');\n      await animateTo(this.body, shimKeyframesHeightAuto(keyframes, this.body.scrollHeight), options);\n      this.body.style.height = 'auto';\n      this.body.style.overflow = 'visible';\n    } else {\n      this.scHide.emit();\n      await stopAnimations(this.body);\n      this.body.style.overflow = 'hidden';\n      const { keyframes, options } = getAnimation(this.el, 'summary.hide');\n      await animateTo(this.body, shimKeyframesHeightAuto(keyframes, this.body.scrollHeight), options);\n      this.body.hidden = true;\n      this.body.style.height = 'auto';\n      this.body.style.overflow = 'visible';\n    }\n  }\n\n  render() {\n    return (\n      <div class={{ 'summary': true, 'summary--open': !this.collapsed }}>\n        {this.collapsible && this.renderHeader()}\n        <div\n          ref={el => (this.body = el as HTMLElement)}\n          class={{\n            'summary__content': true,\n            'summary__content--empty': this.empty() && !formBusy(),\n          }}\n        >\n          <slot />\n        </div>\n        {this.empty() && !formBusy() && <p class=\"empty\">{__('Your cart is empty.', 'surecart')}</p>}\n      </div>\n    );\n  }\n}\n\nsetDefaultAnimation('summary.show', {\n  keyframes: [\n    { height: '0', opacity: '0' },\n    { height: 'auto', opacity: '1' },\n  ],\n  options: { duration: 250, easing: 'ease' },\n});\n\nsetDefaultAnimation('summary.hide', {\n  keyframes: [\n    { height: 'auto', opacity: '1' },\n    { height: '0', opacity: '0' },\n  ],\n  options: { duration: 250, easing: 'ease' },\n});\n"],"mappings":"4aAAA,MAAMA,EAAoB,iyC,8JCoBKC,GAAAC,KAAAC,GAAE,2B,cACJF,GAAAC,KAAAC,GAAE,sB,qiDA0DTF,GAAAC,KAAAE,QAAQH,GAAAC,KAAAC,GAAE,iCAAAE,KAAAC,UAAqDL,GAAAC,KAAAC,GAAE,wBAA4BF,GAAAC,KAAAC,GAAE,wBAAAI,UAAAC,I,sCAIjGP,GAAAC,KAAAE,QAAQH,GAAAC,KAAAC,GAAE,iCAAAE,KAAAC,UAAqDL,GAAAC,KAAAC,GAAE,wBAA4BF,GAAAC,KAAAC,GAAE,oC,oCAIpEF,GAAAC,KAAAC,GAAE,4BAAAE,KAAAI,UAAiDR,GAAAC,KAAAC,GAAE,4BAAAO,EAAA,OAAAC,MAAA,6BAAAC,MAAA,sBAAAC,KAAA,OAAAC,QAAA,YAAAC,OAAA,gBAAAL,EAAA,8EAAAM,EAAA,qBAAAN,EAAA,QAAAO,KAAA,eAAAP,EAAA,QAAAQ,KAAA,mBAAAC,EAAAC,EAAAC,YAAA,MAAAF,SAAA,SAAAA,EAAAG,kBAAAC,EAAAH,EAAAC,YAAA,MAAAE,SAAA,SAAAA,EAAAC,YAAAd,EAAA,QAAAO,KAAA,QAAAL,MAAA,CAAAa,MAAA,wBAAApB,KAAAC,YAAAI,EAAA,oBAAAE,MAAA,cAAAc,KAAA,WAAAC,UAAAC,EAAAR,EAAAC,YAAA,MAAAO,SAAA,SAAAA,EAAAD,SAAAE,OAAAC,EAAAV,EAAAC,YAAA,MAAAS,SAAA,SAAAA,EAAAN,cAAAd,EAAA,QAAAO,KAAA,QAAAL,MAAA,CAAAa,MAAA,wBAAApB,KAAAC,gBAAAyB,EAAAX,EAAAC,YAAA,MAAAU,SAAA,SAAAA,EAAAC,uBAAAtB,EAAA,oBAAAE,MAAA,4BAAAc,KAAA,WAAAG,SAAAI,EAAAb,EAAAC,YAAA,MAAAY,SAAA,SAAAA,EAAAD,wBAAAE,EAAAd,EAAAC,YAAA,MAAAa,SAAA,SAAAA,EAAAZ,cAAAK,WAAAQ,EAAAf,EAAAC,YAAA,MAAAc,SAAA,SAAAA,EAAAR,WAAA,QAAAjB,EAAA,YAAAE,MAAA,cAAAwB,MAAA,QAAAC,MAAAjB,EAAAC,Y,01BAmE1CpB,GAAAC,KAAAC,GAAE,mC,wFAM5DmC,EAAA,gB,wGAQAA,EAAA,gB"}