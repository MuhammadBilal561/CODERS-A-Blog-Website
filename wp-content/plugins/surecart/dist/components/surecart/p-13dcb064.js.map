{"version":3,"names":["multiverse","Map","updateConsumer","_a","state","fields","updater","forEach","field","Universe","create","creator","initialState","el","getElement","wormholes","universe","set","connectedCallback","call","disconnectedCallback","delete","addEventListener","event","stopPropagation","detail","consumer","onOpen","has","connectedCallback_1","disconnectedCallback_1","resolve","Provider","children","getRenderingRef","get","opening"],"sources":["../../node_modules/stencil-wormhole/dist/esm/universe.js"],"sourcesContent":["import { getElement, getRenderingRef } from \"@stencil/core\";\nvar multiverse = new Map();\nvar updateConsumer = function (_a, state) {\n    var fields = _a.fields, updater = _a.updater;\n    fields.forEach(function (field) { updater(field, state[field]); });\n};\nexport var Universe = {\n    create: function (creator, initialState) {\n        var el = getElement(creator);\n        var wormholes = new Map();\n        var universe = { wormholes: wormholes, state: initialState };\n        multiverse.set(creator, universe);\n        var connectedCallback = creator.connectedCallback;\n        creator.connectedCallback = function () {\n            multiverse.set(creator, universe);\n            if (connectedCallback) {\n                connectedCallback.call(creator);\n            }\n        };\n        var disconnectedCallback = creator.disconnectedCallback;\n        creator.disconnectedCallback = function () {\n            multiverse.delete(creator);\n            if (disconnectedCallback) {\n                disconnectedCallback.call(creator);\n            }\n        };\n        el.addEventListener('openWormhole', function (event) {\n            event.stopPropagation();\n            var _a = event.detail, consumer = _a.consumer, onOpen = _a.onOpen;\n            if (wormholes.has(consumer))\n                return;\n            if (typeof consumer !== 'symbol') {\n                var connectedCallback_1 = consumer.connectedCallback, disconnectedCallback_1 = consumer.disconnectedCallback;\n                consumer.connectedCallback = function () {\n                    wormholes.set(consumer, event.detail);\n                    if (connectedCallback_1) {\n                        connectedCallback_1.call(consumer);\n                    }\n                };\n                consumer.disconnectedCallback = function () {\n                    wormholes.delete(consumer);\n                    if (disconnectedCallback_1) {\n                        disconnectedCallback_1.call(consumer);\n                    }\n                };\n            }\n            wormholes.set(consumer, event.detail);\n            updateConsumer(event.detail, universe.state);\n            onOpen === null || onOpen === void 0 ? void 0 : onOpen.resolve(function () { wormholes.delete(consumer); });\n        });\n        el.addEventListener('closeWormhole', function (event) {\n            var consumer = event.detail;\n            wormholes.delete(consumer);\n        });\n    },\n    Provider: function (_a, children) {\n        var state = _a.state;\n        var creator = getRenderingRef();\n        if (multiverse.has(creator)) {\n            var universe = multiverse.get(creator);\n            universe.state = state;\n            universe.wormholes.forEach(function (opening) { updateConsumer(opening, state); });\n        }\n        return children;\n    }\n};\n"],"mappings":"2CACA,IAAIA,EAAa,IAAIC,IACrB,IAAIC,EAAiB,SAAUC,EAAIC,GAC/B,IAAIC,EAASF,EAAGE,OAAQC,EAAUH,EAAGG,QACrCD,EAAOE,SAAQ,SAAUC,GAASF,EAAQE,EAAOJ,EAAMI,GAAQ,GACnE,EACU,IAACC,EAAW,CAClBC,OAAQ,SAAUC,EAASC,GACvB,IAAIC,EAAKC,EAAWH,GACpB,IAAII,EAAY,IAAId,IACpB,IAAIe,EAAW,CAAED,UAAWA,EAAWX,MAAOQ,GAC9CZ,EAAWiB,IAAIN,EAASK,GACxB,IAAIE,EAAoBP,EAAQO,kBAChCP,EAAQO,kBAAoB,WACxBlB,EAAWiB,IAAIN,EAASK,GACxB,GAAIE,EAAmB,CACnBA,EAAkBC,KAAKR,EACvC,CACA,EACQ,IAAIS,EAAuBT,EAAQS,qBACnCT,EAAQS,qBAAuB,WAC3BpB,EAAWqB,OAAOV,GAClB,GAAIS,EAAsB,CACtBA,EAAqBD,KAAKR,EAC1C,CACA,EACQE,EAAGS,iBAAiB,gBAAgB,SAAUC,GAC1CA,EAAMC,kBACN,IAAIrB,EAAKoB,EAAME,OAAQC,EAAWvB,EAAGuB,SAAUC,EAASxB,EAAGwB,OAC3D,GAAIZ,EAAUa,IAAIF,GACd,OACJ,UAAWA,IAAa,SAAU,CAC9B,IAAIG,EAAsBH,EAASR,kBAAmBY,EAAyBJ,EAASN,qBACxFM,EAASR,kBAAoB,WACzBH,EAAUE,IAAIS,EAAUH,EAAME,QAC9B,GAAII,EAAqB,CACrBA,EAAoBV,KAAKO,EACjD,CACA,EACgBA,EAASN,qBAAuB,WAC5BL,EAAUM,OAAOK,GACjB,GAAII,EAAwB,CACxBA,EAAuBX,KAAKO,EACpD,CACA,CACA,CACYX,EAAUE,IAAIS,EAAUH,EAAME,QAC9BvB,EAAeqB,EAAME,OAAQT,EAASZ,OACtCuB,IAAW,MAAQA,SAAgB,OAAS,EAAIA,EAAOI,SAAQ,WAAchB,EAAUM,OAAOK,EAAU,GACpH,IACQb,EAAGS,iBAAiB,iBAAiB,SAAUC,GAC3C,IAAIG,EAAWH,EAAME,OACrBV,EAAUM,OAAOK,EAC7B,GACA,EACIM,SAAU,SAAU7B,EAAI8B,GACpB,IAAI7B,EAAQD,EAAGC,MACf,IAAIO,EAAUuB,IACd,GAAIlC,EAAW4B,IAAIjB,GAAU,CACzB,IAAIK,EAAWhB,EAAWmC,IAAIxB,GAC9BK,EAASZ,MAAQA,EACjBY,EAASD,UAAUR,SAAQ,SAAU6B,GAAWlC,EAAekC,EAAShC,EAAO,GAC3F,CACQ,OAAO6B,CACf,U"}