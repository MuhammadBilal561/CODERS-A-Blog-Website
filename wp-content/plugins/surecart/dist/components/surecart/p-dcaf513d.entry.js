import{r as i,c as t,h as s,a as e}from"./p-cc7ce8c7.js";import{s as o}from"./p-24f06282.js";import{s as n}from"./p-c27fae79.js";import{s as d}from"./p-048f799d.js";import"./p-dd7d2638.js";import{s as r}from"./p-d8da6b4d.js";import{U as c}from"./p-13dcb064.js";import"./p-25433d0f.js";import"./p-f70181c4.js";import"./p-4d73f82a.js";import"./p-1c2e2695.js";import"./p-830ab1a3.js";import"./p-a3a138d6.js";import"./p-7ef0f71c.js";import"./p-50da3ba3.js";import"./p-c3d54c20.js";import"./p-c06b2e12.js";const a="sc-checkout{--sc-form-focus-within-z-index:5;display:block;font-family:var(--sc-font-sans);font-size:var(--sc-checkout-font-size, 16px);position:relative}sc-checkout h3{font-size:var(--sc-input-label-font-size-medium)}sc-alert{margin-bottom:var(--sc-form-row-spacing)}.sc-checkout-container.sc-align-center{max-width:500px;margin-left:auto;margin-right:auto}.sc-checkout-container.sc-align-wide{max-width:800px;margin-left:auto;margin-right:auto}::slotted(*){font-family:var(--sc-font-sans)}";const l=class{constructor(s){i(this,s);this.scOrderUpdated=t(this,"scOrderUpdated",7);this.scOrderFinalized=t(this,"scOrderFinalized",7);this.scOrderError=t(this,"scOrderError",7);this.prices=[];this.product=undefined;this.mode="live";this.formId=undefined;this.modified=undefined;this.currencyCode="usd";this.persistSession=true;this.successUrl="";this.customer=undefined;this.alignment=undefined;this.taxProtocol=undefined;this.disableComponentsValidation=undefined;this.processors=undefined;this.manualPaymentMethods=undefined;this.editLineItems=true;this.removeLineItems=true;this.abandonedCheckoutEnabled=undefined;this.stripePaymentElement=false;this.pricesEntities={};this.productsEntities={};this.checkoutState="idle";this.error=undefined;this.processor="stripe";this.method=undefined;this.isManualProcessor=undefined;this.paymentIntents={};this.isDuplicate=undefined}handleOrderStateUpdate(i){o.checkout=i.detail}handleMethodChange(i){this.method=i.detail}handleAddEntities(i){const{products:t,prices:s}=i.detail;if(Object.keys((t===null||t===void 0?void 0:t.length)||{})){this.productsEntities={...this.productsEntities,...t}}if(Object.keys((s===null||s===void 0?void 0:s.length)||{})){this.pricesEntities={...this.pricesEntities,...s}}}async submit({skip_validation:i}={skip_validation:false}){if(!i){await this.validate()}return await this.sessionProvider.finalize()}async validate(){const i=this.el.querySelector("sc-form");return await i.validate()}componentWillLoad(){const i=document.querySelector("sc-checkout");this.isDuplicate=!!i&&i!==this.el;if(this.isDuplicate)return;c.create(this,this.state())}state(){var i,t,s,e,c,a,l,h,u,p,m,f,v,g,k,y,b,j,x,w,S,z;return{processor:this.processor,method:this.method,selectedProcessorId:this.processor,manualPaymentMethods:this.manualPaymentMethods,processor_data:(i=o.checkout)===null||i===void 0?void 0:i.processor_data,state:this.checkoutState,formState:n.formState.value,paymentIntents:this.paymentIntents,successUrl:this.successUrl,bumps:(s=(t=o.checkout)===null||t===void 0?void 0:t.recommended_bumps)===null||s===void 0?void 0:s.data,order:o.checkout,abandonedCheckoutEnabled:(e=o.checkout)===null||e===void 0?void 0:e.abandoned_checkout_enabled,checkout:o.checkout,shippingEnabled:(c=o.checkout)===null||c===void 0?void 0:c.shipping_enabled,lineItems:((l=(a=o.checkout)===null||a===void 0?void 0:a.line_items)===null||l===void 0?void 0:l.data)||[],editLineItems:this.editLineItems,removeLineItems:this.removeLineItems,loading:n.formState.value==="loading",busy:["updating","finalizing","paying","confirming"].includes(n.formState.value),paying:["finalizing","paying","confirming"].includes(n.formState.value),empty:!["loading","updating"].includes(n.formState.value)&&!((p=(u=(h=o.checkout)===null||h===void 0?void 0:h.line_items)===null||u===void 0?void 0:u.pagination)===null||p===void 0?void 0:p.count),stripePaymentElement:r.config.stripe.paymentElement,stripePaymentIntent:(((f=(m=o.checkout)===null||m===void 0?void 0:m.staged_payment_intents)===null||f===void 0?void 0:f.data)||[]).find((i=>i.processor_type==="stripe")),error:this.error,customer:this.customer,tax_status:(v=o.checkout)===null||v===void 0?void 0:v.tax_status,taxEnabled:(g=o.checkout)===null||g===void 0?void 0:g.tax_enabled,customerShippingAddress:typeof((k=o.checkout)===null||k===void 0?void 0:k.customer)!=="string"?(b=(y=o.checkout)===null||y===void 0?void 0:y.customer)===null||b===void 0?void 0:b.shipping_address:{},shippingAddress:(j=o.checkout)===null||j===void 0?void 0:j.shipping_address,taxStatus:(x=o.checkout)===null||x===void 0?void 0:x.tax_status,taxIdentifier:(w=o.checkout)===null||w===void 0?void 0:w.tax_identifier,totalAmount:(S=o.checkout)===null||S===void 0?void 0:S.total_amount,taxProtocol:this.taxProtocol,lockedChoices:this.prices,products:this.productsEntities,prices:this.pricesEntities,country:"US",loggedIn:d.loggedIn,emailExists:(z=o.checkout)===null||z===void 0?void 0:z.email_exists,formId:o.formId,mode:o.mode,currencyCode:o.currencyCode}}render(){if(this.isDuplicate){return s("sc-alert",{open:true},wp.i18n.__("Due to processor restrictions, only one checkout form is allowed on the page.","surecart"))}return s("div",{class:{"sc-checkout-container":true,"sc-align-center":this.alignment==="center","sc-align-wide":this.alignment==="wide","sc-align-full":this.alignment==="full"}},s("sc-checkout-unsaved-changes-warning",{state:this.checkoutState}),o.validateStock&&s("sc-checkout-stock-alert",null),s(c.Provider,{state:this.state()},s("sc-login-provider",{loggedIn:d.loggedIn,onScSetCustomer:i=>this.customer=i.detail,onScSetLoggedIn:i=>d.loggedIn=i.detail,order:o.checkout},s("sc-form-state-provider",{onScSetCheckoutFormState:i=>this.checkoutState=i.detail},s("sc-form-error-provider",null,s("sc-form-components-validator",{disabled:this.disableComponentsValidation,taxProtocol:o.taxProtocol},s("sc-order-confirm-provider",{"checkout-status":n.formState.value,"success-url":this.successUrl},s("sc-session-provider",{ref:i=>this.sessionProvider=i,prices:this.prices,persist:this.persistSession},s("slot",null))))))),this.state().busy&&s("sc-block-ui",{class:"busy-block-ui",style:{"z-index":"30"}}),["finalizing","paying","confirming","confirmed","redirecting"].includes(n.formState.value)&&s("sc-block-ui",{spinner:true,style:{"--sc-block-ui-opacity":"0.75","z-index":"30"}},n.text.loading[n.formState.value]||wp.i18n.__("Processing payment...","surecart"))))}get el(){return e(this)}};l.style=a;export{l as sc_checkout};
//# sourceMappingURL=p-dcaf513d.entry.js.map