{"version":3,"names":["isBusy","includes","state","loading","getExitUrl","_a","_b","checkout","metadata","success_url","getDiscountedAmount","amount","line_item","total_amount","getScratchAmount","_c","total_savings_amount","getUpsellRemainingTime","timeFormat","expiresAt","upsells_expire_at","now","Date","remaining","Math","floor","formatTimeUnit","unit","getFormattedRemainingTime","time","days","hours","minutes","seconds","isUpsellExpired"],"sources":["./src/store/upsell/getters.ts"],"sourcesContent":["import { state } from './store';\n\n/**\n * Is it busy\n */\nexport const isBusy = () => ['loading', 'busy', 'redirecting'].includes(state.loading);\n\n/**\n * Get the exit url.\n */\nexport const getExitUrl = () => state?.checkout?.metadata?.success_url || state.success_url || null;\n\n/**\n * Get the discounted amount.\n */\nexport const getDiscountedAmount = amount => state?.line_item?.total_amount ?? amount;\n\n/**\n * Get the scratch amount.\n */\nexport const getScratchAmount = amount => (!state?.line_item?.total_savings_amount ? amount : -state?.line_item?.total_savings_amount + state?.line_item?.total_amount);\n\n/**\n * Get upsell remaining time.\n */\nexport const getUpsellRemainingTime = (timeFormat = 'seconds') => {\n  // Get upsell expiration timestamp from checkout.\n  const expiresAt = state.checkout?.upsells_expire_at; // in seconds\n\n  // If no expiration timestamp, return 0.\n  if (!expiresAt) return null;\n\n  // Get current timestamp.\n  const now = Date.now();\n\n  // Get remaining time in seconds.\n  const remaining = Math.floor((expiresAt * 1000 - now) / 1000);\n\n  // If remaining time is less than 0, return 0.\n  if (remaining < 0) return 0;\n\n  // Check time format - seconds, minues, hours.\n  if (timeFormat === 'seconds') return remaining;\n  if (timeFormat === 'minutes') return Math.floor(remaining / 60);\n  if (timeFormat === 'hours') return Math.floor(remaining / 60 / 60);\n};\n\n/**\n * Format time unit - add a zero if unit is less than 10.\n */\nexport const formatTimeUnit = unit => (unit < 10 ? `0${unit}` : `${unit}`);\n\n/**\n * Get formatted remaining time.\n */\nexport const getFormattedRemainingTime = () => {\n  // not loaded.\n  if (!state.checkout?.upsells_expire_at) return '--:--';\n\n  const time = getUpsellRemainingTime('seconds');\n\n  const days = Math.floor(time / (60 * 60 * 24));\n  const hours = Math.floor((time % (60 * 60 * 24)) / (60 * 60));\n  const minutes = Math.floor((time % (60 * 60)) / 60);\n  const seconds = Math.floor(time % 60);\n\n  if (days > 0) {\n    return `${formatTimeUnit(days)}:${formatTimeUnit(hours)}:${formatTimeUnit(minutes)}:${formatTimeUnit(seconds)}`;\n  }\n  if (hours > 0) {\n    return `${formatTimeUnit(hours)}:${formatTimeUnit(minutes)}:${formatTimeUnit(seconds)}`;\n  }\n  return `${formatTimeUnit(minutes)}:${formatTimeUnit(seconds)}`;\n};\n\n/**\n * Is upsell expired.\n */\nexport const isUpsellExpired = () => {\n  // Get remaining time in seconds.\n  const remaining = getUpsellRemainingTime();\n\n  // Make sure we wait until it's set.\n  return getUpsellRemainingTime() === null ? false : remaining <= 0;\n};\n"],"mappings":"0CAKaA,EAAS,IAAM,CAAC,UAAW,OAAQ,eAAeC,SAASC,EAAMC,S,MAKjEC,EAAa,SAAAC,EAAAC,EAAM,QAAAA,GAAAD,EAAAH,IAAK,MAALA,SAAK,SAALA,EAAOK,YAAQ,MAAAF,SAAA,SAAAA,EAAEG,YAAQ,MAAAF,SAAA,SAAAA,EAAEG,cAAeP,EAAMO,aAAe,IAAI,E,MAKtFC,EAAsBC,IAAM,IAAAN,EAAAC,EAAI,OAAAA,GAAAD,EAAAH,IAAK,MAALA,SAAK,SAALA,EAAOU,aAAS,MAAAP,SAAA,SAAAA,EAAEQ,gBAAY,MAAAP,SAAA,EAAAA,EAAIK,CAAM,E,MAKxEG,EAAmBH,IAAM,IAAAN,EAAAC,EAAAS,EAAI,SAAEV,EAAAH,IAAK,MAALA,SAAK,SAALA,EAAOU,aAAS,MAAAP,SAAA,SAAAA,EAAEW,sBAAuBL,KAAUL,EAAAJ,IAAK,MAALA,SAAK,SAALA,EAAOU,aAAS,MAAAN,SAAA,SAAAA,EAAEU,wBAAuBD,EAAAb,IAAK,MAALA,SAAK,SAALA,EAAOU,aAAS,MAAAG,SAAA,SAAAA,EAAEF,aAAY,EAK/J,MAAMI,EAAyB,CAACC,EAAa,a,MAElD,MAAMC,GAAYd,EAAAH,EAAMK,YAAQ,MAAAF,SAAA,SAAAA,EAAEe,kBAGlC,IAAKD,EAAW,OAAO,KAGvB,MAAME,EAAMC,KAAKD,MAGjB,MAAME,EAAYC,KAAKC,OAAON,EAAY,IAAOE,GAAO,KAGxD,GAAIE,EAAY,EAAG,OAAO,EAG1B,GAAIL,IAAe,UAAW,OAAOK,EACrC,GAAIL,IAAe,UAAW,OAAOM,KAAKC,MAAMF,EAAY,IAC5D,GAAIL,IAAe,QAAS,OAAOM,KAAKC,MAAMF,EAAY,GAAK,GAAG,EAM7D,MAAMG,EAAiBC,GAASA,EAAO,GAAK,IAAIA,IAAS,GAAGA,I,MAKtDC,EAA4B,K,MAEvC,MAAKvB,EAAAH,EAAMK,YAAQ,MAAAF,SAAA,SAAAA,EAAEe,mBAAmB,MAAO,QAE/C,MAAMS,EAAOZ,EAAuB,WAEpC,MAAMa,EAAON,KAAKC,MAAMI,GAAQ,GAAK,GAAK,KAC1C,MAAME,EAAQP,KAAKC,MAAOI,GAAQ,GAAK,GAAK,KAAQ,GAAK,KACzD,MAAMG,EAAUR,KAAKC,MAAOI,GAAQ,GAAK,IAAO,IAChD,MAAMI,EAAUT,KAAKC,MAAMI,EAAO,IAElC,GAAIC,EAAO,EAAG,CACZ,MAAO,GAAGJ,EAAeI,MAASJ,EAAeK,MAAUL,EAAeM,MAAYN,EAAeO,I,CAEvG,GAAIF,EAAQ,EAAG,CACb,MAAO,GAAGL,EAAeK,MAAUL,EAAeM,MAAYN,EAAeO,I,CAE/E,MAAO,GAAGP,EAAeM,MAAYN,EAAeO,IAAU,E,MAMnDC,EAAkB,KAE7B,MAAMX,EAAYN,IAGlB,OAAOA,MAA6B,KAAO,MAAQM,GAAa,CAAC,S"}