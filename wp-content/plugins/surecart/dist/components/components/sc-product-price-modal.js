import{proxyCustomElement,HTMLElement,h}from"@stencil/core/internal/client";import{o as onChange,s as state,b as setProduct}from"./watchers.js";import{g as getProductBuyLink,s as submitCartForm,a as getTopLevelError,b as getAdditionalErrorMessages}from"./error.js";import{d as defineCustomElement$b}from"./sc-alert2.js";import{d as defineCustomElement$a}from"./sc-button2.js";import{d as defineCustomElement$9}from"./sc-dialog2.js";import{d as defineCustomElement$8}from"./sc-form2.js";import{d as defineCustomElement$7}from"./sc-form-control2.js";import{d as defineCustomElement$6}from"./sc-icon2.js";import{d as defineCustomElement$5}from"./sc-input2.js";import{d as defineCustomElement$4}from"./sc-price-input2.js";import{d as defineCustomElement$3}from"./sc-spinner2.js";import{d as defineCustomElement$2}from"./sc-visually-hidden2.js";const scProductPriceModalCss=":host{display:block}sc-dialog{--body-spacing:var(--sc-spacing-xx-large);color:var(--sc-color-gray-600);text-decoration:none;font-size:16px}.dialog__header{display:flex;align-items:center;gap:var(--sc-spacing-medium)}.dialog__header-text{line-height:var(--sc-line-height-dense)}.dialog__image img{width:60px;height:60px;display:block}.dialog__action{font-weight:var(--sc-font-weight-bold)}.dialog__product-name{font-size:var(--sc-font-size-small)}",ScProductPriceModal$1=proxyCustomElement(class extends HTMLElement{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.buttonText=void 0,this.addToCart=void 0,this.productId=void 0,this.error=void 0}async submit(){var t,e;if(!this.addToCart){const o=null===(e=null===(t=null===window||void 0===window?void 0:window.scData)||void 0===t?void 0:t.pages)||void 0===e?void 0:e.checkout;if(!o)return;return window.location.assign(getProductBuyLink(this.productId,o))}try{await submitCartForm(this.productId)}catch(t){console.error(t),this.error=t}}componentWillLoad(){onChange(this.productId,(()=>{setTimeout((()=>{var t;null===(t=this.priceInput)||void 0===t||t.triggerFocus()}),50)}))}render(){var t,e,o,s,i,r,d,n,c,a,l,u,m,p,v,g,f,E,_;return(null===(e=null===(t=state[this.productId])||void 0===t?void 0:t.selectedPrice)||void 0===e?void 0:e.ad_hoc)?h("sc-dialog",{open:(null===(o=state[this.productId])||void 0===o?void 0:o.dialog)===((null==this?void 0:this.addToCart)?"ad_hoc_cart":"ad_hoc_buy"),onScRequestClose:()=>setProduct(this.productId,{dialog:null})},h("span",{class:"dialog__header",slot:"label"},!!(null===(i=null===(s=state[this.productId])||void 0===s?void 0:s.product)||void 0===i?void 0:i.image_url)&&h("div",{class:"dialog__image"},h("img",{src:null===(d=null===(r=state[this.productId])||void 0===r?void 0:r.product)||void 0===d?void 0:d.image_url})),h("div",{class:"dialog__header-text"},h("div",{class:"dialog__action"},wp.i18n.__("Enter An Amount","surecart")),h("div",{class:"dialog__product-name"},null===(c=null===(n=state[this.productId])||void 0===n?void 0:n.product)||void 0===c?void 0:c.name))),h("sc-form",{onScSubmit:t=>{t.stopImmediatePropagation(),this.submit()},onScFormSubmit:t=>t.stopImmediatePropagation()},!!this.error&&h("sc-alert",{type:"danger",scrollOnOpen:!0,open:!!this.error,closable:!1},!!getTopLevelError(this.error)&&h("span",{slot:"title",innerHTML:getTopLevelError(this.error)}),(getAdditionalErrorMessages(this.error)||[]).map(((t,e)=>h("div",{innerHTML:t,key:e})))),h("sc-price-input",{ref:t=>this.priceInput=t,value:null===(u=null===(l=null===(a=state[this.productId])||void 0===a?void 0:a.adHocAmount)||void 0===l?void 0:l.toString)||void 0===u?void 0:u.call(l),"currency-code":null===(p=null===(m=state[this.productId])||void 0===m?void 0:m.selectedPrice)||void 0===p?void 0:p.currency,min:null===(g=null===(v=state[this.productId])||void 0===v?void 0:v.selectedPrice)||void 0===g?void 0:g.ad_hoc_min_amount,max:null===(E=null===(f=state[this.productId])||void 0===f?void 0:f.selectedPrice)||void 0===E?void 0:E.ad_hoc_max_amount,onScInput:t=>setProduct(this.productId,{adHocAmount:parseInt(t.target.value)}),required:!0}),h("sc-button",{type:"primary",full:!0,submit:!0,busy:null===(_=state[this.productId])||void 0===_?void 0:_.busy},h("slot",null,this.buttonText||wp.i18n.__("Add To Cart","surecart"))))):null}get el(){return this}static get style(){return scProductPriceModalCss}},[1,"sc-product-price-modal",{buttonText:[1,"button-text"],addToCart:[4,"add-to-cart"],productId:[1,"product-id"],error:[32]}]);function defineCustomElement$1(){"undefined"!=typeof customElements&&["sc-product-price-modal","sc-alert","sc-button","sc-dialog","sc-form","sc-form-control","sc-icon","sc-input","sc-price-input","sc-spinner","sc-visually-hidden"].forEach((t=>{switch(t){case"sc-product-price-modal":customElements.get(t)||customElements.define(t,ScProductPriceModal$1);break;case"sc-alert":customElements.get(t)||defineCustomElement$b();break;case"sc-button":customElements.get(t)||defineCustomElement$a();break;case"sc-dialog":customElements.get(t)||defineCustomElement$9();break;case"sc-form":customElements.get(t)||defineCustomElement$8();break;case"sc-form-control":customElements.get(t)||defineCustomElement$7();break;case"sc-icon":customElements.get(t)||defineCustomElement$6();break;case"sc-input":customElements.get(t)||defineCustomElement$5();break;case"sc-price-input":customElements.get(t)||defineCustomElement$4();break;case"sc-spinner":customElements.get(t)||defineCustomElement$3();break;case"sc-visually-hidden":customElements.get(t)||defineCustomElement$2()}}))}const ScProductPriceModal=ScProductPriceModal$1,defineCustomElement=defineCustomElement$1;export{ScProductPriceModal,defineCustomElement};