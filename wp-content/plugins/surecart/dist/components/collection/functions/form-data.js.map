{"version":3,"file":"form-data.js","sourceRoot":"","sources":["../../src/functions/form-data.ts"],"names":[],"mappings":"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","sourcesContent":["interface FormDataEvent extends Event {\n  readonly formData: FormData;\n}\ninterface FormDataEventInit extends EventInit {\n  formData: FormData;\n}\ndeclare var FormDataEvent: {\n  prototype: FormDataEvent;\n  new (type: string, eventInitDict?: FormDataEventInit): FormDataEvent;\n};\n\nexport interface FormSubmitControllerOptions {\n  /** A function that returns the form containing the form control. */\n  form: (input: unknown) => HTMLFormElement | null;\n  /** A function that returns the form control's name, which will be submitted with the form data. */\n  name: (input: unknown) => string;\n  /** A function that returns the form control's current value. */\n  value: (input: unknown) => unknown | unknown[];\n  /** A function that returns the form control's current disabled state. If disabled, the value won't be submitted. */\n  disabled: (input: unknown) => boolean;\n}\n\nexport class FormSubmitController {\n  form: HTMLFormElement | null = null;\n  input: any;\n  options: FormSubmitControllerOptions;\n  constructor(input: any, options?: Partial<FormSubmitControllerOptions>) {\n    this.input = input;\n    this.options = {\n      form: (input: HTMLInputElement) => this.closestElement('sc-form', input)?.shadowRoot?.querySelector('form') || this.closestElement('form', input),\n      name: (input: HTMLInputElement) => input.name,\n      value: (input: HTMLInputElement) => input.value,\n      disabled: (input: HTMLInputElement) => input.disabled,\n      ...options,\n    };\n\n    this.form = this.options.form(this.input);\n    this.handleFormData = this.handleFormData.bind(this);\n  }\n\n  closestElement(selector, el) {\n    if (!el) return null;\n    return (el && el != document && el != window && el.closest(selector)) || this.closestElement(selector, el.getRootNode().host);\n  }\n\n  addFormData() {\n    if (!this.form) return;\n    this.form.addEventListener('formdata', this.handleFormData);\n  }\n\n  removeFormData() {\n    if (!this.form) return;\n    this.form.removeEventListener('formdata', this.handleFormData);\n  }\n\n  handleFormData(event: FormDataEvent) {\n    const name = this.options.name(this.input);\n    const value = this.options.value(this.input);\n\n    if (typeof name === 'string' && typeof value !== 'undefined') {\n      if (Array.isArray(value)) {\n        (value as unknown[]).forEach(val => {\n          if (val) {\n            event.formData.append(name, (val as string | number | boolean).toString());\n          }\n        });\n      } else {\n        if (value) {\n          event.formData.append(name, (value as string | number | boolean).toString());\n        }\n      }\n    }\n  }\n}\n\nexport const parseFormData = (data: any) => {\n  const {\n    email,\n    name,\n    first_name,\n    last_name,\n    phone,\n    password,\n    shipping_city,\n    shipping_country,\n    shipping_line_1,\n    shipping_line_2,\n    shipping_postal_code,\n    shipping_state,\n    billing_city,\n    billing_country,\n    billing_line_1,\n    billing_line_2,\n    billing_postal_code,\n    billing_state,\n    'tax_identifier.number_type': tax_number_type,\n    'tax_identifier.number': tax_number,\n    ...rest\n  } = data;\n\n  const shipping_address = {\n    ...(shipping_city ? { city: shipping_city } : {}),\n    ...(shipping_country ? { country: shipping_country } : {}),\n    ...(shipping_line_1 ? { line_1: shipping_line_1 } : {}),\n    ...(shipping_line_2 ? { line_2: shipping_line_2 } : {}),\n    ...(shipping_postal_code ? { postal_code: shipping_postal_code } : {}),\n    ...(shipping_state ? { state: shipping_state } : {}),\n  };\n\n  const billing_address = {\n    ...(billing_city ? { city: billing_city } : {}),\n    ...(billing_country ? { country: billing_country } : {}),\n    ...(billing_line_1 ? { line_1: billing_line_1 } : {}),\n    ...(billing_line_2 ? { line_2: billing_line_2 } : {}),\n    ...(billing_postal_code ? { postal_code: billing_postal_code } : {}),\n    ...(billing_state ? { state: billing_state } : {}),\n  };\n\n  return {\n    ...(name ? { name } : {}),\n    ...(email ? { email } : {}),\n    ...(first_name ? { first_name } : {}),\n    ...(last_name ? { last_name } : {}),\n    ...(phone ? { phone } : {}),\n    ...(password ? { password } : {}),\n    ...(Object.keys(shipping_address || {}).length ? { shipping_address } : {}),\n    ...(Object.keys(billing_address || {}).length ? { billing_address } : {}),\n    ...(tax_number_type && tax_number ? { tax_identifier: { number: tax_number, number_type: tax_number_type } } : {}),\n    ...(Object.keys(rest)?.length ? { metadata: rest } : {}),\n  };\n};\n\nexport const reportChildrenValidity = async (element: HTMLElement) => {\n  const items = ([...element.shadowRoot.querySelectorAll('*')] as HTMLElement[]).filter((el: any) => typeof el.reportValidity === 'function') as any;\n  for (const el of items) {\n    const isValid = await el.reportValidity();\n    if (!isValid) {\n      return false;\n    }\n  }\n  return true;\n};\n"]}