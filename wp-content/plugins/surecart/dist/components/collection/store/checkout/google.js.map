{"version":3,"file":"google.js","sourceRoot":"","sources":["../../../src/store/checkout/google.ts"],"names":[],"mappings":"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","sourcesContent":["import { trackEvent } from '../../functions/google';\nimport { maybeConvertAmount } from '../../functions/currency';\nimport { Checkout, LineItem, Product, ShippingMethod } from 'src/types';\n\n/**\n * Handle add to cart event.\n */\nwindow.addEventListener('scAddedToCart', (e: CustomEvent) => {\n  const item: LineItem = e.detail;\n\n  // sanity check.\n  if (!item?.price?.product) return;\n\n  trackEvent('add_to_cart', {\n    currency: item.price?.currency,\n    value: maybeConvertAmount(item?.price?.amount || 0, item.price?.currency || 'USD'),\n    items: [\n      {\n        item_id: (item.price?.product as Product)?.id,\n        item_name: (item.price?.product as Product)?.name,\n        item_variant: (item.variant_options || []).join(' / '),\n        price: maybeConvertAmount(item?.price?.amount || 0, item.price?.currency || 'USD'),\n        currency: item.price?.currency,\n        quantity: item.quantity,\n        discount: item?.discount_amount ? maybeConvertAmount(item?.discount_amount || 0, item.price?.currency || 'USD') : 0,\n      },\n    ],\n  });\n});\n\n/**\n * Handle remove from cart event.\n */\nwindow.addEventListener('scRemovedFromCart', (e: CustomEvent) => {\n  const item: LineItem = e.detail;\n\n  // sanity check.\n  if (!item?.price?.product) return;\n\n  trackEvent('remove_from_cart', {\n    currency: item.price?.currency,\n    value: maybeConvertAmount(item?.price?.amount || 0, item.price?.currency || 'USD'),\n    items: [\n      {\n        item_id: (item.price?.product as Product)?.id,\n        item_name: (item.price?.product as Product)?.name,\n        item_variant: (item.variant_options || []).join(' / '),\n        price: maybeConvertAmount(item?.price?.amount || 0, item.price?.currency || 'USD'),\n        currency: item.price?.currency,\n        quantity: item.quantity,\n        discount: item?.discount_amount ? maybeConvertAmount(item?.discount_amount || 0, item.price?.currency || 'USD') : 0,\n      },\n    ],\n  });\n});\n\n/**\n * Handle view cart event.\n */\nwindow.addEventListener('scViewedCart', (e: CustomEvent) => {\n  const checkout: Checkout = e.detail;\n\n  trackEvent('view_cart', {\n    currency: checkout.currency,\n    value: maybeConvertAmount(checkout.total_amount, checkout.currency),\n    items: (checkout.line_items?.data || []).map(item => ({\n      item_id: (item?.price?.product as Product)?.id,\n      item_name: (item?.price?.product as Product)?.name,\n      currency: item.price?.currency,\n      discount: item.discount_amount ? maybeConvertAmount(item.discount_amount, item.price?.currency) : 0,\n      price: maybeConvertAmount(item?.price?.amount, item.price?.currency),\n      quantity: item.quantity,\n      ...(item?.variant_options?.length ? { item_variant: (item.variant_options || []).join(' / ') } : {}),\n    })),\n  });\n});\n\n/**\n * Handle checkout initiated event.\n */\nwindow.addEventListener('scCheckoutInitiated', (e: CustomEvent) => {\n  const checkout: Checkout = e.detail;\n\n  trackEvent('begin_checkout', {\n    currency: checkout.currency,\n    value: maybeConvertAmount(checkout.total_amount, checkout.currency),\n    items: (checkout.line_items?.data || []).map(item => ({\n      item_id: (item?.price?.product as Product)?.id,\n      item_name: (item?.price?.product as Product)?.name,\n      currency: item.price?.currency,\n      discount: item.discount_amount ? maybeConvertAmount(item.discount_amount, item.price?.currency) : 0,\n      price: maybeConvertAmount(item?.price?.amount, item.price?.currency),\n      quantity: item.quantity,\n      ...(item?.variant_options?.length ? { item_variant: (item.variant_options || []).join(' / ') } : {}),\n    })),\n  });\n});\n\n/**\n * Handle purchase complete event.\n */\nwindow.addEventListener('scCheckoutCompleted', (e: CustomEvent) => {\n  const checkout: Checkout = e.detail;\n\n  trackEvent('purchase', {\n    transaction_id: checkout?.id,\n    value: maybeConvertAmount(checkout?.total_amount, checkout?.currency || 'USD'),\n    currency: (checkout.currency || '').toUpperCase(),\n    items: (checkout?.line_items?.data || []).map(item => ({\n      item_id: (item?.price?.product as Product)?.id,\n      currency: (checkout.currency || '').toUpperCase(),\n      item_name: (item?.price?.product as Product)?.name || '',\n      discount: item?.discount_amount ? maybeConvertAmount(item?.discount_amount || 0, item?.price?.currency || 'USD') : 0,\n      price: maybeConvertAmount(item?.price?.amount || 0, item?.price?.currency || 'USD'),\n      quantity: item?.quantity || 1,\n      ...(item?.variant_options?.length ? { item_variant: (item.variant_options || []).join(' / ') } : {}),\n    })),\n  });\n});\n\n/**\n * Handle payment info added event.\n */\nwindow.addEventListener('scPaymentInfoAdded', (e: CustomEvent) => {\n  const checkout = e.detail;\n\n  trackEvent('add_payment_info', {\n    currency: checkout.currency,\n    value: maybeConvertAmount(checkout.total_amount, checkout.currency),\n    items: (checkout.line_items?.data || []).map(item => ({\n      item_id: (item?.price?.product as Product)?.id,\n      item_name: (item?.price?.product as Product)?.name || '',\n      currency: item.price?.currency,\n      discount: item.discount_amount ? maybeConvertAmount(item.discount_amount, item.price?.currency) : 0,\n      price: maybeConvertAmount(item?.price?.amount, item.price?.currency),\n      quantity: item.quantity,\n      ...(item?.variant_options?.length ? { item_variant: (item.variant_options || []).join(' / ') } : {}),\n    })),\n  });\n});\n\n/**\n * Handle shipping info added event.\n */\nwindow.addEventListener('scShippingInfoAdded', (e: CustomEvent) => {\n  const checkout: Checkout = e.detail;\n  const selectedShippingChoice = checkout?.shipping_choices?.data?.find(method => method.id === checkout?.selected_shipping_choice);\n  const selectedShippingTier = (selectedShippingChoice?.shipping_method as ShippingMethod)?.name || '';\n\n  trackEvent('add_shipping_info', {\n    currency: checkout.currency,\n    value: maybeConvertAmount(checkout.total_amount, checkout.currency),\n    ...(checkout?.discount?.promotion?.code ? { coupon: checkout?.discount?.promotion?.code } : {}),\n    ...(selectedShippingTier ? { shipping_tier: selectedShippingTier } : ''),\n    items: (checkout.line_items?.data || []).map(item => ({\n      item_id: (item?.price?.product as Product)?.id,\n      item_name: (item?.price?.product as Product)?.name || '',\n      currency: item.price?.currency,\n      discount: item.discount_amount ? maybeConvertAmount(item.discount_amount, item.price?.currency) : 0,\n      price: maybeConvertAmount(item?.price?.amount, item.price?.currency),\n      quantity: item.quantity,\n      ...(item?.variant_options?.length ? { item_variant: (item.variant_options || []).join(' / ') } : {}),\n    })),\n  });\n});\n"]}