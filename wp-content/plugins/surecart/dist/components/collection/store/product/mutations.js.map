{"version":3,"file":"mutations.js","sourceRoot":"","sources":["../../../src/store/product/mutations.ts"],"names":[],"mappings":"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","sourcesContent":["import state from './store';\nimport { toggleCart } from '@store/ui';\nimport { addQueryArgs } from '@wordpress/url';\nimport { setProduct } from './setters';\nimport { addCheckoutLineItem } from '@store/checkout/mutations';\n\nexport const submitCartForm = async (productId: string) => {\n  const productState = state[productId];\n  if (!productState) return;\n  if (!productState.selectedPrice?.id) return;\n  if (productState.selectedPrice?.ad_hoc && (null === productState.adHocAmount || undefined === productState.adHocAmount)) return;\n\n  try {\n    setProduct(productId, { busy: true });\n    await addCheckoutLineItem({\n      price: productState.selectedPrice?.id,\n      quantity: Math.max(productState.selectedPrice?.ad_hoc ? 1 : productState.quantity, 1),\n      ...(productState.selectedPrice?.ad_hoc ? { ad_hoc_amount: productState.adHocAmount } : {}),\n      variant: productState.selectedVariant?.id,\n    });\n    toggleCart(true);\n    setProduct(productId, { dialog: null });\n  } catch (e) {\n    console.error(e);\n    state.error = e;\n    throw e; // Re-throw the caught error\n  } finally {\n    setProduct(productId, { busy: false });\n  }\n};\n\n/**\n * Get the product buy link.\n */\nexport const getProductBuyLink = (productId: string, url: string, query = {}) => {\n  const productState = state[productId];\n\n  if (!productState) return;\n  if (!productState.selectedPrice?.id) return;\n  if (productState.selectedPrice?.ad_hoc && !productState.adHocAmount && 0 !== productState.adHocAmount) return;\n\n  return addQueryArgs(url, {\n    line_items: [\n      {\n        price: productState.selectedPrice?.id,\n        quantity: Math.max(productState.selectedPrice?.ad_hoc ? 1 : productState.quantity, 1),\n        ...(productState.selectedPrice?.ad_hoc ? { ad_hoc_amount: productState.adHocAmount } : {}),\n        ...(productState.selectedVariant?.id ? { variant: productState.selectedVariant?.id } : {}),\n      },\n    ],\n    ...query,\n  });\n};\n"]}