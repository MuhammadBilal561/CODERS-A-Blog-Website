{"version":3,"file":"sc-stripe-payment-request.js","sourceRoot":"","sources":["../../../../src/components/ui/stripe-payment-request/sc-stripe-payment-request.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Element, Event, EventEmitter, h, Prop, State, Watch } from '@stencil/core';\nimport { PaymentRequestOptions, Stripe } from '@stripe/stripe-js';\nimport { loadStripe } from '@stripe/stripe-js/pure';\nimport { __ } from '@wordpress/i18n';\nimport { state as checkoutState, onChange as onCheckoutChange  } from '@store/checkout';\n\nimport { createOrUpdateCheckout, finalizeCheckout } from '../../../services/session';\nimport { Checkout, LineItem, Prices, Product, ResponseError } from '../../../types';\nimport { createErrorNotice } from '@store/notices/mutations';\nimport { openWormhole } from 'stencil-wormhole';\n\n@Component({\n  tag: 'sc-stripe-payment-request',\n  styleUrl: 'sc-stripe-payment-request.scss',\n  shadow: false,\n})\nexport class ScStripePaymentRequest {\n  @Element() el: HTMLElement;\n  private request: HTMLDivElement;\n  private stripe: Stripe;\n  private paymentRequest: any;\n  private elements: any;\n  private removeCheckoutListener: () => void;\n\n  /** Your stripe connected account id. */\n  @Prop() stripeAccountId: string;\n\n  /** Stripe publishable key */\n  @Prop() publishableKey: string;\n\n  /** Country */\n  @Prop() country: string = 'US';\n\n  /** Prices */\n  @Prop() prices: Prices;\n\n  /** Label */\n  @Prop() label: string = 'total';\n\n  /** Amount */\n  @Prop() amount: number = 0;\n\n  /** Payment request theme */\n  @Prop() theme: string = 'dark';\n\n  @Prop() error: ResponseError | null;\n\n  /** Is this in debug mode. */\n  @Prop() debug: boolean = false;\n\n  /** Has this loaded */\n  @State() loaded: boolean = false;\n  @State() debugError: string;\n\n  @Event() scFormSubmit: EventEmitter<any>;\n  @Event() scPaid: EventEmitter<void>;\n  @Event() scPayError: EventEmitter<any>;\n  @Event() scSetState: EventEmitter<string>;\n  @Event() scPaymentRequestLoaded: EventEmitter<boolean>;\n  @Event() scUpdateOrderState: EventEmitter<any>;\n\n  private pendingEvent: any;\n\n  private confirming: boolean;\n\n  async componentWillLoad() {\n    if (!this?.publishableKey || !this?.stripeAccountId) {\n      return true;\n    }\n\n    try {\n      this.stripe = await loadStripe(this.publishableKey, { stripeAccount: this.stripeAccountId });\n      this.elements = this.stripe.elements();\n      this.paymentRequest = this.stripe.paymentRequest({\n        country: this.country,\n        requestShipping: true,\n        requestPayerEmail: true,\n        shippingOptions: [\n          {\n            id: 'free',\n            label: 'Free Shipping',\n            detail: 'No shipping required',\n            amount: 0,\n          },\n        ],\n        ...(this.getRequestObject(checkoutState?.checkout) as PaymentRequestOptions),\n      });\n    } catch (e) {\n      console.log(e?.message || __('Stripe could not be loaded', 'surecart'));\n    }\n  }\n\n  handleOrderChange() {\n    if (!this.paymentRequest) return;\n    if (this.pendingEvent) return;\n    this.paymentRequest.update(this.getRequestObject(checkoutState?.checkout));\n  }\n\n  @Watch('loaded')\n  handleLoaded() {\n    this.scPaymentRequestLoaded.emit(true);\n  }\n\n  @Watch('error')\n  handleErrorChange() {\n    if (this.pendingEvent) {\n      this.pendingEvent.complete('error');\n    }\n  }\n\n  async handleShippingChange(ev: any) {\n    const { shippingAddress, updateWith } = ev;\n    try {\n      const order = (await createOrUpdateCheckout({\n        id: checkoutState?.checkout?.id,\n        data: {\n          shipping_address: {\n            ...(shippingAddress?.name ? { name: shippingAddress?.name } : {}),\n            ...(shippingAddress?.addressLine?.[0] ? { line_1: shippingAddress?.addressLine?.[0] } : {}),\n            ...(shippingAddress?.addressLine?.[1] ? { line_2: shippingAddress?.addressLine?.[1] } : {}),\n            ...(shippingAddress?.city ? { city: shippingAddress?.city } : {}),\n            ...(shippingAddress?.country ? { country: shippingAddress?.country } : {}),\n            ...(shippingAddress?.postalCode ? { postal_code: shippingAddress?.postalCode } : {}),\n            ...(shippingAddress?.region ? { state: shippingAddress?.region } : {}),\n          },\n        },\n      })) as Checkout;\n      updateWith({\n        status: 'success',\n        total: {\n          amount: order?.amount_due || 0,\n          label: __('Total', 'surecart'),\n          pending: true,\n        },\n      });\n    } catch (e) {\n      e.updateWith({ status: 'invalid_shipping_address' });\n    }\n  }\n\n  /** Only append price name if there's more than one product price in the session. */\n  getName(item: LineItem) {\n    const otherPrices = Object.keys(this.prices || {}).filter(key => {\n      const price = this.prices[key];\n      // @ts-ignore\n      return price.product === item.price.product.id;\n    });\n\n    let name = '';\n    if (otherPrices.length > 1) {\n      name = `${(item?.price?.product as Product)?.name} \\u2013 ${item?.price?.name}`;\n    } else {\n      name = (item?.price?.product as Product)?.name;\n    }\n    return name;\n  }\n\n  getRequestObject(order: Checkout) {\n    const displayItems = (order?.line_items?.data || []).map(item => {\n      return {\n        label: this.getName(item),\n        amount: item.ad_hoc_amount !== null ? item.ad_hoc_amount : item.subtotal_amount,\n      };\n    });\n\n    return {\n      currency: checkoutState.currencyCode,\n      total: {\n        amount: order?.amount_due || 0,\n        label: __('Total', 'surecart'),\n        pending: true,\n      },\n      displayItems,\n    };\n  }\n\n  componentDidLoad() {\n    this.handleOrderChange();\n    this.removeCheckoutListener = onCheckoutChange('checkout', () => this.handleOrderChange());\n    if (!this.elements) {\n      return;\n    }\n\n    const paymentRequestElement = this.elements.create('paymentRequestButton', {\n      paymentRequest: this.paymentRequest,\n      style: {\n        paymentRequestButton: {\n          theme: this.theme,\n        },\n      },\n    });\n\n    // handle payment method.\n    this.paymentRequest.on('paymentmethod', e => this.handlePaymentMethod(e));\n    this.paymentRequest.on('shippingaddresschange', async ev => await this.handleShippingChange(ev));\n\n    // mount button.\n    this.paymentRequest\n      .canMakePayment()\n      .then(result => {\n        if (!result) {\n          if (location.protocol !== 'https:') {\n            if (this.debug) {\n              this.debugError = __('You must serve this page over HTTPS to display express payment buttons.', 'surecart');\n            }\n            console.log('SSL needed to display payment buttons.');\n          } else {\n            if (this.debug) {\n              this.debugError = __('You do not have any wallets set up in your browser.', 'surecart');\n            }\n            console.log('No wallets available.');\n          }\n          return;\n        }\n        paymentRequestElement.mount(this.request);\n        this.loaded = true;\n      })\n      .catch(e => {\n        console.error(e);\n      });\n  }\n\n  /** Handle the payment method. */\n  async handlePaymentMethod(ev) {\n    const { billing_details } = ev?.paymentMethod;\n    const { shippingAddress } = ev;\n\n    try {\n      this.scSetState.emit('FINALIZE');\n      // update session with shipping/billing\n      (await createOrUpdateCheckout({\n        id: checkoutState?.checkout?.id,\n        data: {\n          email: billing_details?.email,\n          name: billing_details?.name,\n          shipping_address: {\n            ...(shippingAddress?.name ? { name: shippingAddress?.name } : {}),\n            ...(shippingAddress?.addressLine?.[0] ? { line_1: shippingAddress?.addressLine?.[0] } : {}),\n            ...(shippingAddress?.addressLine?.[1] ? { line_2: shippingAddress?.addressLine?.[1] } : {}),\n            ...(shippingAddress?.city ? { city: shippingAddress?.city } : {}),\n            ...(shippingAddress?.country ? { country: shippingAddress?.country } : {}),\n            ...(shippingAddress?.postalCode ? { postal_code: shippingAddress?.postalCode } : {}),\n            ...(shippingAddress?.region ? { state: shippingAddress?.region } : {}),\n          },\n        },\n      })) as Checkout;\n\n      // finalize\n      const session = (await finalizeCheckout({\n        id: checkoutState?.checkout.id,\n        query: {\n          form_id: checkoutState.formId,\n        },\n        processor: { id: 'stripe', manual: false },\n      })) as Checkout;\n\n      // confirm payment\n      this.scSetState.emit('PAYING');\n      await this.confirmPayment(session, ev);\n      this.scSetState.emit('PAID');\n      // paid.\n      this.scPaid.emit();\n      // Report to the browser that the confirmation was successful, prompting\n      // it to close the browser payment method collection interface.\n      ev.complete('success');\n    } catch (e) {\n      console.error(e);\n      this.scPayError.emit(e);\n      createErrorNotice(e);\n      ev.complete('fail');\n    } finally {\n      this.confirming = false;\n    }\n  }\n\n  async confirmPayment(val: Checkout, ev) {\n    // must be finalized\n    if (val?.status !== 'finalized') return;\n    // must have a secret\n    if (!val?.payment_intent?.processor_data?.stripe?.client_secret) return;\n    // need an external_type\n    if (!val?.payment_intent?.processor_data?.stripe?.type) return;\n    // must have an external intent id\n    if (!val?.payment_intent?.external_intent_id) return;\n    // prevent possible double-charges\n    if (this.confirming) return;\n    this.confirming = true;\n\n    let response;\n    if (val?.payment_intent?.processor_data?.stripe?.type == 'setup') {\n      response = await this.confirmCardSetup(val?.payment_intent?.processor_data?.stripe.client_secret, ev);\n    } else {\n      response = await this.confirmCardPayment(val?.payment_intent?.processor_data?.stripe.client_secret, ev);\n    }\n    if (response?.error) {\n      throw response.error;\n    }\n    // Check if the PaymentIntent requires any actions and if so let Stripe.js\n    // handle the flow. If using an API version older than \"2019-02-11\"\n    // instead check for: `paymentIntent.status === \"requires_source_action\"`.\n    if (response?.paymentIntent?.status === 'requires_action' || response?.paymentIntent?.status === 'requires_source_action') {\n      // Let Stripe.js handle the rest of the payment flow.\n      const result = await this.stripe.confirmCardPayment(val?.payment_intent?.processor_data?.stripe.client_secret);\n      // The payment failed -- ask your customer for a new payment method.\n      if (result.error) {\n        throw result.error;\n      }\n      return result;\n    }\n\n    return response;\n  }\n\n  /** Confirm card payment. */\n  confirmCardPayment(secret, ev) {\n    return this.stripe.confirmCardPayment(secret, { payment_method: ev.paymentMethod.id }, { handleActions: false });\n  }\n\n  /** Confirm card setup. */\n  confirmCardSetup(secret, ev) {\n    return this.stripe.confirmCardSetup(secret, { payment_method: ev.paymentMethod.id }, { handleActions: false });\n  }\n\n  disconnectedCallback() {\n    this.removeCheckoutListener();\n  }\n\n  render() {\n    return (\n      <div class={{ 'request': true, 'request--loaded': this.loaded }}>\n        {this.debug && this.debugError && (\n          <div>\n            <slot name=\"debug-fallback\" />\n            <sc-alert type=\"info\" open>\n              <span slot=\"title\">{__('Express Payment', 'surecart')}</span>\n              {this.debugError}\n            </sc-alert>\n          </div>\n        )}\n        <div class=\"sc-payment-request-button\" part=\"button\" ref={el => (this.request = el as HTMLDivElement)}></div>\n      </div>\n    );\n  }\n}\n\n\nopenWormhole(ScStripePaymentRequest, [ 'prices'], false);\n"]}