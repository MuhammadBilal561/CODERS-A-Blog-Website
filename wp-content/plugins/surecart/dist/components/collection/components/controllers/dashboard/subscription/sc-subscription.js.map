{"version":3,"file":"sc-subscription.js","sourceRoot":"","sources":["../../../../../src/components/controllers/dashboard/subscription/sc-subscription.tsx"],"names":[],"mappings":"AAAA,OAAO,EAAE,SAAS,EAAE,OAAO,EAAE,QAAQ,EAAE,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,MAAM,eAAe,CAAC;AAC7E,OAAO,EAAE,OAAO,EAAE,EAAE,EAAE,MAAM,iBAAiB,CAAC;AAC9C,OAAO,EAAE,YAAY,EAAE,MAAM,gBAAgB,CAAC;AAC9C,OAAO,QAAQ,MAAM,6BAA6B,CAAC;AAEnD,OAAO,EAAE,cAAc,EAAE,MAAM,4BAA4B,CAAC;AAC5D,OAAO,EAAE,oBAAoB,EAAE,MAAM,6BAA6B,CAAC;AAMnE,MAAM,OAAO,cAAc;;;;;;;;;;;;;;;EAuCzB,iBAAiB;IACf,cAAc,CAAC,IAAI,CAAC,EAAE,EAAE,GAAG,EAAE;MAC3B,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;QACtB,IAAI,CAAC,eAAe,EAAE,CAAC;OACxB;IACH,CAAC,CAAC,CAAC;EACL,CAAC;EAED,KAAK,CAAC,mBAAmB;;IACvB,MAAM,CAAC,GAAG,OAAO,CAAC,EAAE,CAAC,kEAAkE,EAAE,UAAU,CAAC,CAAC,CAAC;IACtG,IAAI,CAAC,CAAC;MAAE,OAAO;IACf,IAAI;MACF,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;MACjB,IAAI,CAAC,YAAY,GAAG,CAAC,MAAM,QAAQ,CAAC;QAClC,IAAI,EAAE,YAAY,CAAC,6BAA6B,MAAA,IAAI,CAAC,YAAY,0CAAE,EAAE,GAAG,EAAE;UACxE,MAAM,EAAE,CAAC,OAAO,EAAE,eAAe,EAAE,gBAAgB,EAAE,iBAAiB,EAAE,UAAU,EAAE,kBAAkB,EAAE,qBAAqB,EAAE,UAAU,EAAE,iBAAiB,CAAC;SAC9J,CAAC;QACF,MAAM,EAAE,OAAO;QACf,IAAI,EAAE;UACJ,oBAAoB,EAAE,IAAI;SAC3B;OACF,CAAC,CAAiB,CAAC;KACrB;IAAC,OAAO,CAAC,EAAE;MACV,IAAI,CAAC,aAAD,CAAC,uBAAD,CAAC,CAAE,OAAO,EAAE;QACd,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC,OAAO,CAAC;OACxB;WAAM;QACL,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC,sBAAsB,EAAE,UAAU,CAAC,CAAC;OACrD;MACD,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;KAC3B;YAAS;MACR,IAAI,CAAC,IAAI,GAAG,KAAK,CAAC;KACnB;EACH,CAAC;EAED,KAAK,CAAC,iBAAiB;;IACrB,IAAI;MACF,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC;MAChB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;MACjB,IAAI,CAAC,YAAY,GAAG,CAAC,MAAM,QAAQ,CAAC;QAClC,IAAI,EAAE,YAAY,CAAC,6BAA6B,MAAA,IAAI,CAAC,YAAY,0CAAE,EAAE,QAAQ,EAAE;UAC7E,MAAM,EAAE,CAAC,OAAO,EAAE,eAAe,EAAE,gBAAgB,EAAE,iBAAiB,EAAE,UAAU,EAAE,kBAAkB,EAAE,qBAAqB,EAAE,UAAU,EAAE,iBAAiB,CAAC;SAC9J,CAAC;QACF,MAAM,EAAE,OAAO;OAChB,CAAC,CAAiB,CAAC;KACrB;IAAC,OAAO,CAAC,EAAE;MACV,IAAI,CAAC,KAAK,GAAG,CAAA,CAAC,aAAD,CAAC,uBAAD,CAAC,CAAE,OAAO,KAAI,EAAE,CAAC,sBAAsB,EAAE,UAAU,CAAC,CAAC;KACnE;YAAS;MACR,IAAI,CAAC,IAAI,GAAG,KAAK,CAAC;KACnB;EACH,CAAC;EAED,4BAA4B;EAC5B,KAAK,CAAC,eAAe;;IACnB,IAAI;MACF,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;MACpB,IAAI,CAAC,YAAY,GAAG,CAAC,MAAM,MAAM,QAAQ,CAAC;QACxC,IAAI,EAAE,YAAY,CAAC,6BAA6B,IAAI,CAAC,cAAc,KAAI,MAAA,IAAI,CAAC,YAAY,0CAAE,EAAE,CAAA,EAAE,EAAE;UAC9F,MAAM,EAAE,CAAC,OAAO,EAAE,eAAe,EAAE,gBAAgB,CAAC;UACpD,GAAG,CAAC,IAAI,CAAC,KAAK,IAAI,EAAE,CAAC;SACtB,CAAC;OACH,CAAC,CAAiB,CAAC;KACrB;IAAC,OAAO,CAAC,EAAE;MACV,IAAI,CAAC,aAAD,CAAC,uBAAD,CAAC,CAAE,OAAO,EAAE;QACd,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC,OAAO,CAAC;OACxB;WAAM;QACL,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC,sBAAsB,EAAE,UAAU,CAAC,CAAC;OACrD;MACD,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;KAC3B;YAAS;MACR,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;KACtB;EACH,CAAC;EAED,UAAU,CAAC,YAA0B;;IACnC,IAAI,OAAO,CAAA,MAAA,YAAY,aAAZ,YAAY,uBAAZ,YAAY,CAAE,KAAK,0CAAE,OAAO,CAAA,KAAK,QAAQ,EAAE;MACpD,OAAO,oBAAoB,CAAC,YAAY,aAAZ,YAAY,uBAAZ,YAAY,CAAE,KAAK,CAAC,CAAC;KAClD;IACD,OAAO,EAAE,CAAC,cAAc,EAAE,UAAU,CAAC,CAAC;EACxC,CAAC;EAED,iBAAiB,CAAC,YAAY;IAC5B,MAAM,GAAG,GAAG,oCAA8B,YAAY,EAAE,YAAY,GAAiC,CAAC;IAEtG,IAAI,CAAA,YAAY,aAAZ,YAAY,uBAAZ,YAAY,CAAE,oBAAoB,KAAI,YAAY,CAAC,qBAAqB,EAAE;MAC5E,OAAO,CACL;QACG,GAAG;;QAAG,OAAO,CAAC,EAAE,CAAC,+BAA+B,EAAE,UAAU,CAAC,CAAC;QAAE,GAAG;QACpE,sBAAgB,IAAI,EAAE,YAAY,CAAC,qBAAqB,GAAG,IAAI,EAAE,KAAK,EAAC,MAAM,EAAC,GAAG,EAAC,SAAS,EAAC,IAAI,EAAC,SAAS,GAAkB,CACvH,CACR,CAAC;KACH;IACD,IAAI,YAAY,CAAC,MAAM,KAAK,UAAU,IAAI,YAAY,CAAC,YAAY,EAAE;MACnE,OAAO,CACL;QACG,GAAG;;QAAG,OAAO,CAAC,EAAE,CAAC,qBAAqB,EAAE,UAAU,CAAC,CAAC;;QAAE,sBAAgB,IAAI,EAAE,YAAY,CAAC,YAAY,GAAG,IAAI,EAAE,KAAK,EAAC,MAAM,EAAC,GAAG,EAAC,SAAS,EAAC,IAAI,EAAC,SAAS,GAAkB,CACrK,CACR,CAAC;KACH;IACD,IAAI,YAAY,CAAC,MAAM,KAAK,QAAQ,IAAI,YAAY,CAAC,qBAAqB,EAAE;MAC1E,OAAO,CACL;QACG,GAAG;;QAAG,OAAO,CAAC,EAAE,CAAC,qBAAqB,EAAE,UAAU,CAAC,CAAC;QAAE,GAAG;QAC1D,sBAAgB,IAAI,EAAE,YAAY,CAAC,qBAAqB,GAAG,IAAI,EAAE,KAAK,EAAC,MAAM,EAAC,GAAG,EAAC,SAAS,EAAC,IAAI,EAAC,SAAS,GAAkB,CACvH,CACR,CAAC;KACH;IAED,OAAO,GAAG,CAAC;EACb,CAAC;EAED,WAAW;IACT,OAAO,YAAM,IAAI,EAAC,OAAO,IAAE,EAAE,CAAC,mCAAmC,EAAE,UAAU,CAAC,CAAQ,CAAC;EACzF,CAAC;EAED,aAAa;IACX,OAAO,CACL,2BAAqB,KAAK,EAAE,EAAE,WAAW,EAAE,GAAG,EAAE,iBAAe,CAAC;MAC9D,WAAK,KAAK,EAAE,EAAE,OAAO,EAAE,OAAO,EAAE;QAC9B,mBAAa,KAAK,EAAE,EAAE,KAAK,EAAE,KAAK,EAAE,YAAY,EAAE,QAAQ,EAAE,GAAgB;QAC5E,mBAAa,KAAK,EAAE,EAAE,KAAK,EAAE,KAAK,EAAE,YAAY,EAAE,QAAQ,EAAE,GAAgB;QAC5E,mBAAa,KAAK,EAAE,EAAE,KAAK,EAAE,KAAK,EAAE,GAAgB,CAChD,CACc,CACvB,CAAC;EACJ,CAAC;EAED,aAAa;IACX,IAAI,IAAI,CAAC,OAAO,EAAE;MAChB,OAAO,IAAI,CAAC,aAAa,EAAE,CAAC;KAC7B;IAED,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;MACtB,OAAO,IAAI,CAAC,WAAW,EAAE,CAAC;KAC3B;IAED,OAAO,CACL,EAAC,QAAQ;MACP,oCAA8B,YAAY,EAAE,IAAI,CAAC,YAAY,EAAE,sBAAsB,EAAE,IAAI,CAAC,sBAAsB;QAChH,+BAAyB,YAAY,EAAE,IAAI,CAAC,YAAY,GAA4B,CACvD,CACtB,CACZ,CAAC;EACJ,CAAC;EAED,MAAM;;IACJ,MAAM,mBAAmB,GAAG,CAAA,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,YAAY,CAAC,cAAc,MAAI,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,YAAY,CAAC,cAAc,CAAA,CAAC;IAEnG,OAAO,CACL,2BAAqB,OAAO,EAAE,IAAI,CAAC,OAAO,IAAI,EAAE,CAAC,cAAc,EAAE,UAAU,CAAC,EAAE,KAAK,EAAC,cAAc,EAAC,KAAK,EAAE,IAAI,CAAC,KAAK;MACjH,CAAC,CAAC,IAAI,CAAC,YAAY,IAAI,CACtB,eAAS,IAAI,EAAC,KAAK,EAAC,KAAK,EAAC,8BAA8B;QACrD,IAAI,CAAC,sBAAsB,IAAI,mBAAmB,IAAI,CACrD,iBAAW,IAAI,EAAC,MAAM,EAAC,IAAI,EAAE,IAAI,CAAC,sBAAsB;UACtD,eAAS,IAAI,EAAC,aAAa,EAAC,IAAI,EAAC,QAAQ,GAAW;UACnD,EAAE,CAAC,uBAAuB,EAAE,UAAU,CAAC,CAC9B,CACb;QACA,CAAC,mBAAmB,IAAI,CACvB,iBACE,IAAI,EAAC,MAAM,EACX,IAAI,EAAE,YAAY,CAAC,MAAM,CAAC,QAAQ,CAAC,IAAI,EAAE;YACvC,MAAM,EAAE,QAAQ;YAChB,KAAK,EAAE,gBAAgB;YACvB,EAAE,EAAE,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,YAAY,CAAC,EAAE;YACzB,GAAG,CAAC,CAAA,MAAA,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,YAAY,0CAAE,SAAS,MAAK,KAAK,CAAC,CAAC,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC;WACzE,CAAC;UAEF,eAAS,IAAI,EAAC,aAAa,EAAC,IAAI,EAAC,QAAQ,GAAW;UACnD,EAAE,CAAC,oBAAoB,EAAE,UAAU,CAAC,CAC3B,CACb;QACA,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,MAAA,IAAI,CAAC,YAAY,0CAAE,cAAc,CAAC,CAAC,MAAM,IAAI,CAC1D,iBAAW,IAAI,EAAC,MAAM,EAAC,OAAO,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,mBAAmB,EAAE;UAC9D,eAAS,IAAI,EAAC,WAAW,EAAC,IAAI,EAAC,QAAQ,GAAW;UACjD,EAAE,CAAC,yBAAyB,EAAE,UAAU,CAAC,CAChC,CACb;QACA,CAAA,MAAA,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,YAAY,0CAAE,oBAAoB,EAAC,CAAC,CAAC,CAC1C,iBAAW,IAAI,EAAC,MAAM,EAAC,OAAO,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,iBAAiB,EAAE;UAC5D,eAAS,IAAI,EAAC,QAAQ,EAAC,IAAI,EAAC,QAAQ,GAAW;UAC9C,EAAE,CAAC,cAAc,EAAE,UAAU,CAAC,CACrB,CACb,CAAC,CAAC,CAAC,CACF,CAAA,MAAA,IAAI,CAAC,YAAY,0CAAE,MAAM,MAAK,UAAU;WACxC,MAAA,IAAI,CAAC,YAAY,0CAAE,qBAAqB,CAAA;UACxC,IAAI,CAAC,UAAU,IAAI,CACjB,iBAAW,IAAI,EAAC,MAAM,EAAC,OAAO,EAAE,GAAG,EAAE,CAAC,CAAC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;UAC7D,eAAS,IAAI,EAAC,GAAG,EAAC,IAAI,EAAC,QAAQ,GAAW;UACzC,EAAE,CAAC,aAAa,EAAE,UAAU,CAAC,CACpB,CACb,CACF;QACA,CAAA,MAAA,IAAI,CAAC,YAAY,0CAAE,MAAM,MAAK,UAAU,IAAI,CAC3C,iBACE,IAAI,EAAC,MAAM,KACP,CAAC,CAAC,CAAC,CAAA,MAAA,IAAI,CAAC,YAAY,0CAAE,cAAc,CAAA;YACtC,CAAC,CAAC;cACE,OAAO,EAAE,GAAG,EAAE,CAAC,CAAC,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC;aAC9C;YACH,CAAC,CAAC;cACE,IAAI,EAAE,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,sBAAsB;aACnC,CAAC;UAEN,eAAS,IAAI,EAAC,QAAQ,EAAC,IAAI,EAAC,QAAQ,GAAW;UAC9C,EAAE,CAAC,aAAa,EAAE,UAAU,CAAC,CACpB,CACb,CACO,CACX;MAED,eAAS,KAAK,EAAE,EAAE,YAAY,EAAE,QAAQ,EAAE,EAAE,SAAS,UAClD,IAAI,CAAC,aAAa,EAAE,CACb;MAET,IAAI,CAAC,IAAI,IAAI,mBAAa,OAAO,SAAe;MAEjD,wBACE,YAAY,EAAE,IAAI,CAAC,YAAY,EAC/B,QAAQ,EAAE,IAAI,CAAC,QAAQ,EACvB,IAAI,EAAE,IAAI,CAAC,WAAW,EACtB,gBAAgB,EAAE,GAAG,EAAE,CAAC,CAAC,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC,EAClD,WAAW,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,eAAe,EAAE,GACzC;MACF,kCACE,YAAY,EAAE,IAAI,CAAC,YAAY,EAC/B,IAAI,EAAE,IAAI,CAAC,gBAAgB,EAC3B,gBAAgB,EAAE,GAAG,EAAE,CAAC,CAAC,IAAI,CAAC,gBAAgB,GAAG,KAAK,CAAC,EACvD,WAAW,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,eAAe,EAAE,GACzC,CACkB,CACvB,CAAC;EACJ,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CACF","sourcesContent":["import { Component, Element, Fragment, h, Prop, State } from '@stencil/core';\nimport { sprintf, __ } from '@wordpress/i18n';\nimport { addQueryArgs } from '@wordpress/url';\nimport apiFetch from '../../../../functions/fetch';\nimport { Subscription, SubscriptionProtocol } from '../../../../types';\nimport { onFirstVisible } from '../../../../functions/lazy';\nimport { productNameWithPrice } from '../../../../functions/price';\n@Component({\n  tag: 'sc-subscription',\n  styleUrl: 'sc-subscription.scss',\n  shadow: true,\n})\nexport class ScSubscription {\n  @Element() el: HTMLScSubscriptionsListElement;\n\n  /** The subscription ID */\n  @Prop() subscriptionId: string;\n\n  /** Whether to show the cancel button */\n  @Prop() showCancel: boolean;\n\n  /** Heading to display */\n  @Prop() heading: string;\n\n  /** Query to pass to the API */\n  @Prop() query: object;\n\n  /** The subscription protocol */\n  @Prop() protocol: SubscriptionProtocol;\n\n  /** The subscription */\n  @Prop({ mutable: true }) subscription: Subscription;\n\n  /** Update the payment method url */\n  @Prop() updatePaymentMethodUrl: string;\n\n  /** Loading state */\n  @State() loading: boolean;\n\n  /** Cancel modal */\n  @State() cancelModal: boolean;\n\n  /** Resubscribe modal */\n  @State() resubscribeModal: boolean;\n\n  /**  Busy state */\n  @State() busy: boolean;\n\n  /** Error message */\n  @State() error: string;\n\n  componentWillLoad() {\n    onFirstVisible(this.el, () => {\n      if (!this.subscription) {\n        this.getSubscription();\n      }\n    });\n  }\n\n  async cancelPendingUpdate() {\n    const r = confirm(__('Are you sure you want to cancel the pending update to your plan?', 'surecart'));\n    if (!r) return;\n    try {\n      this.busy = true;\n      this.subscription = (await apiFetch({\n        path: addQueryArgs(`surecart/v1/subscriptions/${this.subscription?.id}/`, {\n          expand: ['price', 'price.product', 'current_period', 'period.checkout', 'purchase', 'purchase.license', 'license.activations', 'discount', 'discount.coupon'],\n        }),\n        method: 'PATCH',\n        data: {\n          purge_pending_update: true,\n        },\n      })) as Subscription;\n    } catch (e) {\n      if (e?.message) {\n        this.error = e.message;\n      } else {\n        this.error = __('Something went wrong', 'surecart');\n      }\n      console.error(this.error);\n    } finally {\n      this.busy = false;\n    }\n  }\n\n  async renewSubscription() {\n    try {\n      this.error = '';\n      this.busy = true;\n      this.subscription = (await apiFetch({\n        path: addQueryArgs(`surecart/v1/subscriptions/${this.subscription?.id}/renew`, {\n          expand: ['price', 'price.product', 'current_period', 'period.checkout', 'purchase', 'purchase.license', 'license.activations', 'discount', 'discount.coupon'],\n        }),\n        method: 'PATCH',\n      })) as Subscription;\n    } catch (e) {\n      this.error = e?.message || __('Something went wrong', 'surecart');\n    } finally {\n      this.busy = false;\n    }\n  }\n\n  /** Get all subscriptions */\n  async getSubscription() {\n    try {\n      this.loading = true;\n      this.subscription = (await await apiFetch({\n        path: addQueryArgs(`surecart/v1/subscriptions/${this.subscriptionId || this.subscription?.id}`, {\n          expand: ['price', 'price.product', 'current_period'],\n          ...(this.query || {}),\n        }),\n      })) as Subscription;\n    } catch (e) {\n      if (e?.message) {\n        this.error = e.message;\n      } else {\n        this.error = __('Something went wrong', 'surecart');\n      }\n      console.error(this.error);\n    } finally {\n      this.loading = false;\n    }\n  }\n\n  renderName(subscription: Subscription) {\n    if (typeof subscription?.price?.product !== 'string') {\n      return productNameWithPrice(subscription?.price);\n    }\n    return __('Subscription', 'surecart');\n  }\n\n  renderRenewalText(subscription) {\n    const tag = <sc-subscription-status-badge subscription={subscription}></sc-subscription-status-badge>;\n\n    if (subscription?.cancel_at_period_end && subscription.current_period_end_at) {\n      return (\n        <span>\n          {tag} {sprintf(__('Your plan will be canceled on', 'surecart'))}{' '}\n          <sc-format-date date={subscription.current_period_end_at * 1000} month=\"long\" day=\"numeric\" year=\"numeric\"></sc-format-date>\n        </span>\n      );\n    }\n    if (subscription.status === 'trialing' && subscription.trial_end_at) {\n      return (\n        <span>\n          {tag} {sprintf(__('Your plan begins on', 'surecart'))} <sc-format-date date={subscription.trial_end_at * 1000} month=\"long\" day=\"numeric\" year=\"numeric\"></sc-format-date>\n        </span>\n      );\n    }\n    if (subscription.status === 'active' && subscription.current_period_end_at) {\n      return (\n        <span>\n          {tag} {sprintf(__('Your plan renews on', 'surecart'))}{' '}\n          <sc-format-date date={subscription.current_period_end_at * 1000} month=\"long\" day=\"numeric\" year=\"numeric\"></sc-format-date>\n        </span>\n      );\n    }\n\n    return tag;\n  }\n\n  renderEmpty() {\n    return <slot name=\"empty\">{__('This subscription does not exist.', 'surecart')}</slot>;\n  }\n\n  renderLoading() {\n    return (\n      <sc-stacked-list-row style={{ '--columns': '2' }} mobile-size={0}>\n        <div style={{ padding: '0.5em' }}>\n          <sc-skeleton style={{ width: '30%', marginBottom: '0.75em' }}></sc-skeleton>\n          <sc-skeleton style={{ width: '20%', marginBottom: '0.75em' }}></sc-skeleton>\n          <sc-skeleton style={{ width: '40%' }}></sc-skeleton>\n        </div>\n      </sc-stacked-list-row>\n    );\n  }\n\n  renderContent() {\n    if (this.loading) {\n      return this.renderLoading();\n    }\n\n    if (!this.subscription) {\n      return this.renderEmpty();\n    }\n\n    return (\n      <Fragment>\n        <sc-subscription-next-payment subscription={this.subscription} updatePaymentMethodUrl={this.updatePaymentMethodUrl}>\n          <sc-subscription-details subscription={this.subscription}></sc-subscription-details>\n        </sc-subscription-next-payment>\n      </Fragment>\n    );\n  }\n\n  render() {\n    const paymentMethodExists = this?.subscription.payment_method || this?.subscription.manual_payment;\n\n    return (\n      <sc-dashboard-module heading={this.heading || __('Current Plan', 'surecart')} class=\"subscription\" error={this.error}>\n        {!!this.subscription && (\n          <sc-flex slot=\"end\" class=\"subscription__action-buttons\">\n            {this.updatePaymentMethodUrl && paymentMethodExists && (\n              <sc-button type=\"link\" href={this.updatePaymentMethodUrl}>\n                <sc-icon name=\"credit-card\" slot=\"prefix\"></sc-icon>\n                {__('Update Payment Method', 'surecart')}\n              </sc-button>\n            )}\n            {!paymentMethodExists && (\n              <sc-button\n                type=\"link\"\n                href={addQueryArgs(window.location.href, {\n                  action: 'create',\n                  model: 'payment_method',\n                  id: this?.subscription.id,\n                  ...(this?.subscription?.live_mode === false ? { live_mode: false } : {}),\n                })}\n              >\n                <sc-icon name=\"credit-card\" slot=\"prefix\"></sc-icon>\n                {__('Add Payment Method', 'surecart')}\n              </sc-button>\n            )}\n            {!!Object.keys(this.subscription?.pending_update).length && (\n              <sc-button type=\"link\" onClick={() => this.cancelPendingUpdate()}>\n                <sc-icon name=\"x-octagon\" slot=\"prefix\"></sc-icon>\n                {__('Cancel Scheduled Update', 'surecart')}\n              </sc-button>\n            )}\n            {this?.subscription?.cancel_at_period_end ? (\n              <sc-button type=\"link\" onClick={() => this.renewSubscription()}>\n                <sc-icon name=\"repeat\" slot=\"prefix\"></sc-icon>\n                {__('Restore Plan', 'surecart')}\n              </sc-button>\n            ) : (\n              this.subscription?.status !== 'canceled' &&\n              this.subscription?.current_period_end_at &&\n              this.showCancel && (\n                <sc-button type=\"link\" onClick={() => (this.cancelModal = true)}>\n                  <sc-icon name=\"x\" slot=\"prefix\"></sc-icon>\n                  {__('Cancel Plan', 'surecart')}\n                </sc-button>\n              )\n            )}\n            {this.subscription?.status === 'canceled' && (\n              <sc-button\n                type=\"link\"\n                {...(!!this.subscription?.payment_method\n                  ? {\n                      onClick: () => (this.resubscribeModal = true),\n                    }\n                  : {\n                      href: this?.updatePaymentMethodUrl,\n                    })}\n              >\n                <sc-icon name=\"repeat\" slot=\"prefix\"></sc-icon>\n                {__('Resubscribe', 'surecart')}\n              </sc-button>\n            )}\n          </sc-flex>\n        )}\n\n        <sc-card style={{ '--overflow': 'hidden' }} noPadding>\n          {this.renderContent()}\n        </sc-card>\n\n        {this.busy && <sc-block-ui spinner></sc-block-ui>}\n\n        <sc-cancel-dialog\n          subscription={this.subscription}\n          protocol={this.protocol}\n          open={this.cancelModal}\n          onScRequestClose={() => (this.cancelModal = false)}\n          onScRefresh={() => this.getSubscription()}\n        />\n        <sc-subscription-reactivate\n          subscription={this.subscription}\n          open={this.resubscribeModal}\n          onScRequestClose={() => (this.resubscribeModal = false)}\n          onScRefresh={() => this.getSubscription()}\n        />\n      </sc-dashboard-module>\n    );\n  }\n}\n"]}