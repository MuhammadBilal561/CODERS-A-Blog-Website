{"version":3,"file":"sc-subscription-variation-confirm.js","sourceRoot":"","sources":["../../../../../src/components/controllers/dashboard/subscription-variation-confirm/sc-subscription-variation-confirm.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, h, Prop, State } from '@stencil/core';\nimport { __ } from '@wordpress/i18n';\nimport { addQueryArgs } from '@wordpress/url';\nimport { Product, Subscription, Price } from '../../../../types';\nimport { getVariantFromValues } from '../../../../functions/util';\n\n@Component({\n  tag: 'sc-subscription-variation-confirm',\n  styleUrl: 'sc-subscription-variation-confirm.scss',\n  shadow: false,\n})\nexport class ScSubscriptionVariationConfirm {\n  @Prop() heading: string;\n  @Prop() product: Product;\n  @Prop() price: Price;\n  @Prop() subscription: Subscription;\n  @State() busy: boolean = false;\n  @State() variantValues: Array<string> = [];\n\n  constructor() {\n    // Bind the submit function to the component instance\n    this.handleSubmit = this.handleSubmit.bind(this);\n  }\n\n  componentWillLoad() {\n    this.variantValues = this.subscription?.variant_options;\n  }\n  \n  async handleSubmit() {\n    this.busy = true;\n    \n    const selectedVariant = getVariantFromValues({ variants: this.product?.variants?.data, values: this.variantValues });\n    \n    // confirm ad_hoc amount.\n    if (this.price?.ad_hoc) {\n      return window.location.assign(\n        addQueryArgs(window.location.href, {\n          action: 'confirm_amount',\n          price_id: this.price?.id,\n          variant: selectedVariant?.id,\n        }),\n      );\n    }\n\n    return window.location.assign(\n      addQueryArgs(window.location.href, {\n        action: 'confirm',\n        variant: selectedVariant?.id,\n      }),\n    );\n  }\n\n  buttonText() {\n    if (this.price?.ad_hoc) {\n      if (this.price?.id === (this.subscription?.price as Price)?.id) {\n        return __('Update Amount', 'surecart');\n      }\n      return __('Choose Amount', 'surecart');\n    }\n    return __('Next', 'surecart');\n  }\n  render() {\n    return (\n      <sc-dashboard-module heading={this.heading || __('Enter An Amount', 'surecart')} class=\"subscription-switch\">\n        <sc-card>\n          <sc-form onScSubmit={this.handleSubmit}>\n            <div class=\"sc-product-variation-choice-wrap\">\n              {(this.product?.variant_options?.data || []).map(({name, values, id }, index) => {\n                return (\n                  <sc-select\n                    exportparts=\"base:select__base, input, form-control, label, help-text, trigger, panel, caret, menu__base, spinner__base, empty\"\n                    part=\"name__input\"\n                    value={this.subscription?.variant_options?.[index] || ''}\n                    onScChange={(e: any) => {\n                      this.variantValues[index] = e.detail.value;\n                    }}\n                    label={name}\n                    choices={values?.map(label => ({\n                      label,\n                      value: label,\n                    }))}\n                    unselect={false}\n                    key={id}\n                  />\n                );\n              })}\n            </div>\n            <sc-button type=\"primary\" full submit loading={this.busy}>\n              {this.buttonText()} <sc-icon name=\"arrow-right\" slot=\"suffix\"></sc-icon>\n            </sc-button>\n          </sc-form>\n        </sc-card>\n        {this.busy && <sc-block-ui style={{ zIndex: '9' }}></sc-block-ui>}\n      </sc-dashboard-module>\n    );\n  }\n}\n"]}